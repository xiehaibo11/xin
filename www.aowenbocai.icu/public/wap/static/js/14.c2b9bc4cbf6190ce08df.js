webpackJsonp([14],{"/ZlU":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("VKJ3"),i=s("hZWC"),o=s("UgVH"),n=void 0,r={name:"join",data:function(){return{selected:"2",readArr:[],cur:0,show:!1,buy:1,perPage:14,currentPage:1,lastPage:"",loadText:"上拉加载更多",textShow:!0,contentH:0,allLoaded:!1,topStatus:""}},components:{progressCircle:i.a,joinBuySimple:o.a,BackLayout:a.a},watch:{url:function(){this.loadTop()}},computed:{symbol:function(){return this.url.indexOf("?")>-1?"&":"?"},loadState:function(){return this.$store.state.page.loadState},unit:function(){return this.$store.state.setting.lottery_unit},url:function(){return"/index/lottery/game"},options:function(){return this.$store.state.lotteryNav},pageData:function(){return this.$store.state.joinList}},methods:{choseTab:function(t){this.$router.push({path:t})},toOrders:function(t,e,s){-1==this.readArr.indexOf(e)&&this.readArr.push(e),this.$router.push({path:"/jc/join/detail",query:{lottery_id:t,id:e,i:s}})},toOrders2:function(t){this.$store.commit("setPageYOffset",this.$refs.wrapper.scrollTop),-1==this.readArr.indexOf(t.orderInfo.id)&&this.readArr.push(t.orderInfo.id),this.$router.push({path:"/jc/join/detail",query:{lottery_id:t.orderInfo.lottery_id,id:t.orderInfo.id,i:t.index,buy:t.buy}})},updateJoinList:function(t){var e=this,s=0==t?1:Math.ceil(t/this.perPage);this.$axios(this.url+this.symbol+"page="+s).then(function(t){var s=t.data;e.$store.commit("updataJoinList",s)})},getData:function(t){var e=this;this.$axios(this.url+this.symbol+"page="+t).then(function(t){var s=t.data;e.$store.commit("setJoinList",s.data),e.$set(e,"lastPage",s.last_page),e.$set(e,"perPage",s.per_page),e.textShow=!0,s.data.length?e.currentPage==e.lastPage?(e.allLoaded=!0,e.loadText="没有更多了"):(e.allLoaded=!1,e.loadText="上拉加载更多"):e.loadText="暂无合买方案"})},loadTop:function(){var t=this;this.currentPage=1,this.getData(1),setTimeout(function(){t.$refs.loadmore.onTopLoaded()},1e3)},loadBottom:function(){var t=this;this.textShow=!1,this.currentPage++,console.log(this.currentPage),this.$axios(this.url+this.symbol+"page="+this.currentPage).then(function(e){var s=e.data;t.$store.commit("loadMoreJoinList",s.data),t.textShow=!0,t.$set(t,"lastPage",s.last_page),t.$set(t,"currentPage",s.current_page),t.$refs.loadmore.onBottomLoaded(),t.lastPage==t.currentPage?(t.allLoaded=!0,t.loadText="没有更多了"):(t.allLoaded=!1,t.loadText="上拉加载更多")})},handleTopChange:function(t){this.topStatus=t}},mounted:function(){this.contentH=document.documentElement.clientHeight-135},created:function(){},beforeRouteEnter:function(t,e,s){n="/jc/join/detail"==e.path||"/jc/search"==e.path,s()},beforeRouteLeave:function(t,e,s){"/jc/join/detail"==t.path||"/jc/userRecord"==t.path||"/jc/search"==t.path?(this.$store.commit("setPageYOffset",this.$refs.wrapper.scrollTop),this.$store.commit("setKeepAlivePage","jcGendan")):this.$store.commit("delKeepAlivePage","jcGendan"),s()},activated:function(){if(n?this.$refs.wrapper.scrollTop=this.$store.state.pageYOffset:(this.currentPage=1,this.getData(1)),this.$store.state.updateIndex>-1){var t=0==this.$store.state.updateIndex?1:Math.ceil(this.$store.state.updateIndex/this.perPage);this.updateJoinList(t)}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("header",{staticClass:"mint-header"},[s("div",{staticClass:"mint-header-button is-left"}),t._v(" "),s("h1",{staticClass:"mint-header-title"},[s("ul",{staticClass:"top-tab cf"},[s("li",{on:{click:function(e){return t.choseTab("/jc/gd")}}},[t._v("跟单")]),t._v(" "),s("li",{staticClass:"active",on:{click:function(e){return t.choseTab("/jc/join")}}},[t._v("合买")])])]),t._v(" "),s("div",{staticClass:"mint-header-button is-right"})]),t._v(" "),s("div",{ref:"wrapper",staticClass:"content",style:{height:t.contentH+"px"},nativeOn:{scroll:function(e){return t.scrollEvent(e)}}},[s("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop,"bottom-method":t.loadBottom,"bottom-all-loaded":t.allLoaded,"max-distance":100,"auto-fill":!1,"bottom-distance":10},on:{"top-status-change":t.handleTopChange}},[s("div",{staticClass:"mint-loadmore-top",attrs:{slot:"top"},slot:"top"},[s("span",{directives:[{name:"show",rawName:"v-show",value:"pull"===t.topStatus,expression:"topStatus === 'pull'"}],class:{rotate:"drop"===t.topStatus}},[t._v("↓")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"loading"===t.topStatus,expression:"topStatus === 'loading'"}]},[s("mt-spinner",{attrs:{type:"triple-bounce",color:"#e50e03"}})],1),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"drop"===t.topStatus,expression:"topStatus === 'drop'"}]},[t._v("↑")])]),t._v(" "),s("div",{staticClass:"scroll-wrapper"},[s("div",{staticClass:"card"},t._l(t.pageData,function(e,a){return s("div",{key:a,staticClass:"join-list border-bottom-1px"},[s("div",{staticClass:"mint-cell-allow-right join-link",on:{click:function(s){return t.toOrders(e.lottery_id,e.id,a)}}},[s("div",{staticClass:"title flex-box",class:{"c-3":t.readArr.indexOf(e.id)>-1}},[s("span",[t._v("\n                                 "+t._s(e.title)+"\n                                "),s("em",{staticClass:"f-mini c-3"},[t._v("第"+t._s(e.issue)+"期")])]),t._v(" "),s("span",{staticClass:"flex tr"},[s("em",{staticClass:"f-mini c-4"},[t._v("状态: ")]),t._v(" "),0==e.ure_finsh?[s("em",{staticClass:"num org"},[t._v("已满员")])]:[0==e.status?s("em",{staticClass:"f-sm c-3"},[t._v("等待开奖")]):t._e(),t._v(" "),1==e.status?s("em",{staticClass:"f-sm suc"},[t._v("已中奖")]):t._e(),t._v(" "),2==e.status?s("em",{staticClass:"f-sm c-3"},[t._v("未中奖")]):t._e(),t._v(" "),6==e.status?s("em",{staticClass:"f-sm c-3"},[t._v("流产撤单")]):t._e(),t._v(" "),7==e.status?s("em",{staticClass:"f-sm c-3"},[t._v("系统撤单")]):t._e()]],2)]),t._v(" "),s("div",{staticClass:"flex-box flex-start"},[s("div",{staticClass:"progress"},[s("progress-circle",{attrs:{progress:e.buyprecent,"bd-progress":e.bdprecent}})],1),t._v(" "),s("div",{staticClass:"flex info"},[s("div",{staticClass:"nickname"},[s("em",{staticClass:"f-mini c-4"},[t._v("发起人: ")]),t._v(t._s(e.nickname)+"\n                                        "),s("span",{staticClass:"join-level"},[e.queen>0?s("span",[s("i",{staticClass:"hg"},[s("sub",{class:"lv"+e.queen})])]):t._e(),t._v(" "),e.sunNum>0?s("span",[s("i",{staticClass:"ty"},[s("sub",{class:"lv"+e.sunNum})])]):t._e(),t._v(" "),e.MoonNum>0?s("span",[s("i",{staticClass:"yl"},[s("sub",{class:"lv"+e.MoonNum})])]):t._e(),t._v(" "),e.starNum>0?s("span",[s("i",{staticClass:"xx"},[s("sub",{class:"lv"+e.starNum})])]):t._e()])]),t._v(" "),s("div",{staticClass:"flex-box det"},[s("div",{staticClass:"flex tl"},[s("p",{staticClass:"num org"},[t._v(t._s(e.total_money)),s("em",{staticClass:"f-mini c-3"},[t._v(t._s(t.unit))])]),t._v(" "),s("p",{staticClass:"f-mini c-3"},[t._v("方案金额")])]),t._v(" "),s("div",{staticClass:"flex tl"},[s("p",{staticClass:"num org"},[t._v(t._s(e.ure)),s("em",{staticClass:"f-mini c-3"},[t._v(t._s(t.unit))])]),t._v(" "),s("p",{staticClass:"f-mini c-3"},[t._v("剩余金额")])])])])]),t._v(" "),e.ure_finsh<0?s("div",{staticStyle:{height:"8px"}}):t._e()]),t._v(" "),e.ure_finsh>0?[s("div",{staticClass:"join-buy-box"},[s("join-buy-simple",{attrs:{max:e.ure,"order-info":e,index:a},on:{"do-buy":t.toOrders2}})],1)]:t._e()],2)}),0),t._v(" "),t.textShow?s("div",{staticClass:"tc flex-box f-sm loading c-3"},[t._v(t._s(t.loadText))]):t._e()])])],1)])},staticRenderFns:[]};var c=s("VU/8")(r,l,!1,function(t){s("T4Zk")},"data-v-66d4dd74",null);e.default=c.exports},FiIs:function(t,e){},T4Zk:function(t,e){},UgVH:function(t,e,s){"use strict";var a={name:"joinBuy",components:{inputNumber:s("XYHu").a},props:{max:{type:Number,default:1/0},index:{},orderInfo:{type:Object}},data:function(){return{value:1}},computed:{unit:function(){return this.$store.state.setting.lottery_unit}},methods:{submitOrder:function(){var t={buy:this.value,orderInfo:this.orderInfo,index:this.index};this.$emit("do-buy",t)}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"join-buy flex-box"},[s("input-number",{attrs:{max:t.max,min:1,step:1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),s("em",{staticClass:"f-mini c-3",staticStyle:{"margin-left":"5px"}},[t._v("份")]),t._v(" "),s("mt-button",{staticClass:"btn-buy",attrs:{type:"danger",size:"small"},nativeOn:{click:function(e){return t.submitOrder(e)}}},[t._v("购买")])],1)},staticRenderFns:[]};var o=s("VU/8")(a,i,!1,function(t){s("FiIs")},"data-v-43584d9a",null);e.a=o.exports}});