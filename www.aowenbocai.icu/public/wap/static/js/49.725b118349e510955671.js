webpackJsonp([49],{"/w2C":function(t,s){},"7wSo":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i={components:{SafeCheck:e("V/qW").a},data:function(){return{checkWay:0,loading:!1,steps:1,password1:"",password2:"",oldPwd:"",telYzm:"",emailYzm:""}},computed:{lockTel:function(){return 1!==this.$store.state.lockInfo.tel},lockEmail:function(){return 1!==this.$store.state.lockInfo.email},isYzm:function(){return!!Number(this.$store.state.setting.tel_checked)},isEmail:function(){return!!Number(this.$store.state.setting.email_checked)},isChose:function(){return!(!this.isYzm&&!this.isEmail)}},methods:{toNext:function(){this.password1&&this.password2?this.password1.length<6||this.password2.length<6?this.$toast("安全密码长度要求为（至少6位）！"):this.password1===this.password2?this.steps=2:this.$toast("两次输入的安全密码不相同！"):this.$toast("安全密码不能为空！")},checkTel:function(){var t=this;this.lockTel?(this.checkWay=2,this.steps=3):this.$messagebox.confirm("您还未绑定手机，立即去绑定?").then(function(){t.$router.push({path:"/setTel"})}).catch(function(t){})},checkEmail:function(){var t=this;this.lockEmail?(this.checkWay=3,this.steps=3):this.$messagebox.confirm("您还未绑定邮箱，立即去绑定?").then(function(){t.$router.push({path:"/setEmail"})}).catch(function(t){})},choseWay:function(t){1==t&&(this.checkWay=1,this.steps=3),2==t&&this.checkTel(),3==t&&this.checkEmail()},sumbit:function(){var t=this;this.loading=!0;var s=void 0,e=void 0;1==this.checkWay?(s="/web/user/changeSafePwdByPwd",e={oldpwd:this.oldPwd,password:this.password1,password2:this.password2}):2==this.checkWay?(s="/web/user/changeSafePwdByTel",e={yzm:this.telYzm,password:this.password1,password2:this.password2}):3==this.checkWay&&(s="/web/user/changeSafePwdByEmail",e={yzm:this.emailYzm,password:this.password1,password2:this.password2}),this.$axios.post(s,e).then(function(s){var e=s.data;e.err?1==e.err&&setTimeout(function(){t.steps=1},1e3):setTimeout(function(){t.$router.goBack(-1)},1e3),t.$toast({message:e.msg,duration:1e3}),t.loading=!1}).catch(function(t){console.log(t)})}}},a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"steps"},[e("span",{class:{active:t.steps>=1}}),t._v(" "),e("span",{class:{active:t.steps>=2}}),t._v(" "),e("span",{class:{active:t.steps>=3}})]),t._v(" "),1==t.steps?e("div",{staticClass:"step1"},[e("div",{staticClass:"input-title"},[t._v("设置新安全密码")]),t._v(" "),e("div",[e("mt-field",{attrs:{label:"新密码",placeholder:"请输入新安全密码(至少6位)",type:"password"},model:{value:t.password1,callback:function(s){t.password1=s},expression:"password1"}}),t._v(" "),e("mt-field",{attrs:{label:"重复密码",placeholder:"请再次输入新安全密码(至少6位)",type:"password"},model:{value:t.password2,callback:function(s){t.password2=s},expression:"password2"}})],1),t._v(" "),e("div",{staticClass:"btn-box"},[e("mt-button",{attrs:{type:"danger",size:"large"},nativeOn:{click:function(s){return t.toNext(s)}}},[t._v("\n                下一步\n            ")])],1)]):t._e(),t._v(" "),2==t.steps?e("div",{staticClass:"step2"},[e("div",{staticClass:"input-title"},[t._v("选择安全验证方式")]),t._v(" "),e("div",{staticClass:"chose detail"},[e("mt-cell",{attrs:{title:"验证原安全密码",label:"能记住原安全密码可选此方式","is-link":""},nativeOn:{click:function(s){return t.choseWay(1)}}},[e("i",{staticClass:"iconfont icon-mima2",attrs:{slot:"icon"},slot:"icon"})]),t._v(" "),t.isYzm?e("mt-cell",{attrs:{title:"验证已绑定手机",label:"已绑定手机且该手机能接收短信","is-link":""},nativeOn:{click:function(s){return t.choseWay(2)}}},[e("i",{staticClass:"iconfont icon-ai-bind-cel",attrs:{slot:"icon"},slot:"icon"})]):t._e(),t._v(" "),t.isEmail?e("mt-cell",{attrs:{title:"验证已绑定邮箱",label:"已绑定邮箱且该邮箱能接收邮件","is-link":""},nativeOn:{click:function(s){return t.choseWay(3)}}},[e("i",{staticClass:"iconfont icon-mail",attrs:{slot:"icon"},slot:"icon"})]):t._e()],1)]):t._e(),t._v(" "),3==t.steps?e("div",{staticClass:"step3"},[1==t.checkWay?e("div",[e("div",{staticClass:"input-title"},[t._v("安全验证")]),t._v(" "),e("div",[e("mt-field",{attrs:{label:"原密码",placeholder:"请输入原安全密码",type:"password"},model:{value:t.oldPwd,callback:function(s){t.oldPwd=s},expression:"oldPwd"}})],1)]):t._e(),t._v(" "),2==t.checkWay?e("div",[e("div",{staticClass:"input-title"},[t._v("安全验证")]),t._v(" "),e("safe-check",{attrs:{url:"/web/user/sendSafePwdMsg","check-way":1},model:{value:t.telYzm,callback:function(s){t.telYzm=s},expression:"telYzm"}})],1):t._e(),t._v(" "),3==t.checkWay?e("div",[e("div",{staticClass:"input-title"},[t._v("安全验证")]),t._v(" "),e("safe-check",{attrs:{url:"/web/user/sendSafePwdEmail","check-way":2},model:{value:t.emailYzm,callback:function(s){t.emailYzm=s},expression:"emailYzm"}})],1):t._e(),t._v(" "),3==t.steps?e("div",{staticClass:"btn-box"},[e("mt-button",{attrs:{type:"danger",size:"large"},nativeOn:{click:function(s){return t.sumbit(s)}}},[t.loading?e("mt-spinner",{staticClass:"btn-loading",attrs:{slot:"icon",type:3,size:15,color:"#fff"},slot:"icon"}):t._e(),t._v("\n                确认重置\n            ")],1)],1):t._e(),t._v(" "),3==t.steps?e("div",{staticClass:"tc"},[e("a",{staticClass:"link f-sm",staticStyle:{"text-decoration":"underline"},on:{click:function(s){t.steps=2}}},[t._v("更换验证方式")])]):t._e()]):t._e()])},staticRenderFns:[]};var c=e("VU/8")(i,a,!1,function(t){e("/w2C")},"data-v-7af81ed2",null);s.default=c.exports}});