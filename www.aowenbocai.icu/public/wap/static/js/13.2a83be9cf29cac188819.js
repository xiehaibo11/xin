webpackJsonp([13],{NGLu:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("VFnh"),a=e("hZWC"),r=e("XYHu"),o={name:"joinDetail",components:{stopChase:i.a,progressCircle:a.a,inputNumber:r.a},data:function(){return{loading:!0,orders:{},isShow:!1,chaseShow:!1,joinShow:!1,joinList:[],orderLoading:!1,value:1,orderVisible:!1}},computed:{money:function(){return this.$store.state.userinfo.money},contentH:function(){return this.$store.state.clientHeight-93},lottery_id:function(){return this.$route.query.lottery_id},id:function(){return this.$route.query.id},lotteryUnit:function(){return this.$store.state.setting.lottery_unit},isGain:function(){return this.$store.state.setting.isGain},chaseIssue:function(){return this.orders.expect.length},mulTotal:function(){var t=0;for(var s in this.orders.expect)t+=this.orders.expect[s].multiple;return t},getPerMoney:function(){var t=this.$bet.accDiv(Number(this.orders.total_money),Number(this.orders.total_share),3);return t||1}},methods:{buyMoney:function(t){return this.$bet.accMul(this.getPerMoney,Number(t),3)},getListData:function(){var t=this;this.$axios.get("/index/orders/joinlist",{params:{name:this.orders.name,buyid:this.orders.id}}).then(function(s){var e=s.data;t.$set(t,"joinList",e.data)})},getOrderInfo:function(){var t=this;this.$axios.get("/web/orders/getDetails",{params:{id:this.id,lottery_id:this.lottery_id}}).then(function(s){var e=s.data;t.$set(t,"orders",e)})},getJoinList:function(){this.joinShow?this.joinShow=!1:(this.joinShow=!0,this.joinList.length||this.getListData())},updateExpect:function(t){this.$set(this.orders,"expect",t)},updateJoinList:function(){this.$store.commit("setJoinIndex",this.$route.query.i),this.getListData(),this.getOrderInfo()},submitOrder:function(){var t=this;this.$store.commit("setLoadStatus",!0),this.$axios("/index/moblie/checkLogin").then(function(s){var e=s.data;t.$store.commit("setBauth",e.status),t.$store.commit("setLoadStatus",!1),e.status?(t.$store.dispatch("getUserInfo"),t.orderVisible=!0):t.$router.replace({path:"/login",query:{redirect:t.$router.currentRoute.fullPath}})})},goPay:function(){this.$router.replace({path:"/pay",query:{redirect:this.$router.currentRoute.fullPath}})},payment:function(){var t=this;this.orderLoading=!0,this.$axios.post("/web/orders/buyJoin",{buy_id:this.orders.id,lottery_id:this.orders.lottery_id,money:this.value}).then(function(s){var e=s.data;e.err||(t.value=1,t.$store.dispatch("getUserInfo")),t.orderVisible=!1,t.orderLoading=!1,setTimeout(function(){t.$messagebox({title:"提示",message:e.msg})},200),t.updateJoinList()}).catch(function(t){console.log(t)})}},created:function(){var t=this;this.$store.commit("setJoinIndex",-1),this.orders={},this.joinShow=!1,this.joinList=[],this.isShow=!1,this.chaseShow=!1,this.loading=!0,this.$axios.get("/index/orders/getDetails",{params:{id:this.id,lottery_id:this.lottery_id}}).then(function(s){var e=s.data;t.$set(t,"orders",e),t.loading=!1}),this.$store.commit("setKeepAlivePage","joinDetail"),this.$route.query.buy&&(this.value=this.$route.query.buy,this.orderVisible=!0)},beforeRouteLeave:function(t,s,e){"/login"==t.path||"/pay"==t.path?this.$store.commit("setKeepAlivePage","joinDetail"):this.$store.commit("delKeepAlivePage","joinDetail"),e()}},n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[t.loading?e("div",{staticClass:"loading"},[e("mt-spinner",{attrs:{type:3}})],1):t._e(),t._v(" "),t.loading?t._e():e("div",{staticClass:"contentH",style:{height:t.contentH+"px"}},[e("div",{staticClass:"order-header pd-sm border-bottom-1px"},[e("span",[e("img",{attrs:{src:t.orders.image,alt:"",width:"35"}})]),t._v(" "),e("b",[t._v(t._s(t.orders.title))]),t._v(" "),e("span",{staticClass:"c-3 f-mini"},[t.orders.ischase?[t._v("追号合买 共追号"+t._s(t.chaseIssue)+"期")]:t._e()],2),t._v(" "),e("div",{staticClass:"f-sm mt-sm c-2"},[e("div",[e("span",[t._v("发起人： "),e("em",{staticClass:"f-mini"},[t._v(t._s(t.orders.nickname))])])]),t._v(" "),e("div",[e("span",[t._v("合买宣言： "),e("em",{staticClass:"f-mini"},[t._v(t._s(t.orders.declaration))])])])])]),t._v(" "),e("div",{staticClass:"join-cont flex-box border-bottom-1px"},[e("div",{staticClass:"progress tc border-right-1px"},[e("progress-circle",{attrs:{progress:t.orders.progress.progress,"bd-progress":t.orders.progress.assure_progress}}),t._v(" "),e("div",{staticClass:"f-mini c-3 tc"},[t._v("合买进度")])],1),t._v(" "),e("div",{staticClass:"progress-info"},[e("p",[e("span",{staticClass:"label"},[t._v("方案金额：")]),t._v(" "),e("span",{staticClass:"red f-large"},[t._v(t._s(t.orders.total_money)+" "),e("em",{staticClass:"f-mini c-3"},[t._v(t._s(t.lotteryUnit))])])]),t._v(" "),e("p",[e("span",{staticClass:"label"},[t._v("总份数：")]),t._v(" "),e("span",{staticClass:"red f-large"},[t._v(t._s(t.orders.total_share)+" "),e("em",{staticClass:"f-mini c-3"},[t._v("份")])])]),t._v(" "),e("p",[e("span",{staticClass:"label"},[t._v("剩余份数：")]),t._v(" "),e("span",{staticClass:"f-large",class:{red:t.orders.progress.lost_num>0}},[t._v(t._s(t.orders.progress.lost_num)+" "),e("em",{staticClass:"f-mini c-3"},[t._v("份")])])]),t._v(" "),e("p",[e("span",{staticClass:"label"},[t._v("每份金额：")]),t._v(" "),e("span",{staticClass:"red f-large"},[t._v(t._s(t.getPerMoney)+" "),e("em",{staticClass:"f-mini c-3"},[t._v(t._s(t.lotteryUnit))])])]),t._v(" "),t.isGain?e("p",[e("span",{staticClass:"label"},[t._v("盈利佣金：")]),t._v(" "),e("span",[t._v(t._s(t.orders.gain)+" "),e("em",{staticClass:"f-mini c-3"},[t._v("%")])])]):t._e(),t._v(" "),t.isGain?e("p",[e("span",{staticClass:"label"},[t._v("承诺保底：")]),t._v(" "),e("span",[t._v(t._s(t.orders.assure_money)+" "),e("em",{staticClass:"f-mini c-3"},[t._v("份 (占"+t._s(t.orders.progress.assure_progress)+"%)")])])]):t._e(),t._v(" "),e("p",[e("span",{staticClass:"label"},[t._v("截止时间：")]),t._v(" "),e("span",{staticClass:"label"},[t._v(t._s(t.orders.end_time))])])])]),t._v(" "),e("div",{staticClass:"pd card border-bottom-1px"},[e("span",{staticClass:"join-title"},[t._v("方案状态")]),e("span",{domProps:{innerHTML:t._s(t.orders.status_txt)}})]),t._v(" "),t.orders.ischase?t._e():e("div",{staticClass:"pd order-cont card border-bottom-1px"},[e("span",{staticClass:"join-title"},[t._v("开奖号码")]),t._v(" "),t.orders.expect[0].code.length?t._l(t.orders.expect[0].code,function(s){return e("span",{staticClass:"red code"},[e("b",[t._v(t._s(s))])])}):e("span",[t._v("--")])],2),t._v(" "),e("div",{staticClass:"order-detail card order-cont border-bottom-1px"},[e("div",{staticClass:"title flex-box",class:{"border-bottom-1px":t.isShow},on:{click:function(s){t.isShow=!t.isShow}}},[e("span",{staticClass:"join-title"},[t._v("方案内容")]),0==t.orders.show||t.orders.isShow||t.orders.fristBuy?e("em",[t._v("共"+t._s(t.orders.betting.length)+"条")]):t._e(),t._v(" "),0==t.orders.show||t.orders.isShow||t.orders.fristBuy?e("span",{staticClass:"flex tr"},[e("i",{staticClass:"iconfont icon-xiajiantou c-3",class:{hide:!t.isShow}})]):t._e(),t._v(" "),1!=t.orders.show||t.orders.isShow||t.orders.fristBuy?t._e():[e("span",{staticClass:"flex tl"},[t._v("截止后公开")])],t._v(" "),2!=t.orders.show||t.orders.isShow||t.orders.fristBuy?t._e():[e("span",{staticClass:"flex tl"},[t._v("仅跟单人可见")])],t._v(" "),3!=t.orders.show||t.orders.isShow||t.orders.fristBuy?t._e():[e("span",{staticClass:"flex tl"},[t._v("完全保密")])]],2),t._v(" "),0==t.orders.show||t.orders.isShow||t.orders.fristBuy?[e("ul",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"chose-code c-3"},t._l(t.orders.betting,function(s){return e("li",[e("span",{domProps:{innerHTML:t._s(s)}})])}),0)]:t._e()],2),t._v(" "),e("div",{staticClass:"order-detail card border-bottom-1px"},[e("div",{staticClass:"title flex-box",class:{"border-bottom-1px":t.chaseShow},on:{click:function(s){t.chaseShow=!t.chaseShow}}},[e("span",{staticClass:"join-title"},[t._v("期号详情 ")]),e("em",[t._v("共"+t._s(t.chaseIssue)+"期")]),t._v(" "),e("span",{staticClass:"flex tr"},[e("i",{staticClass:"iconfont icon-xiajiantou c-3",class:{hide:!t.chaseShow}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.chaseShow,expression:"chaseShow"}],staticClass:"c-3 chase-detail"},[e("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",{staticStyle:{"text-align":"left","padding-left":"2px"},attrs:{width:"22%"}},[t._v("期号")]),t._v(" "),e("th",{staticStyle:{"text-align":"left","padding-left":"2px"},attrs:{width:"20%"}},[t._v("开奖号码")]),t._v(" "),e("th",{attrs:{width:"10%"}},[t._v("倍数")]),t._v(" "),e("th",{attrs:{width:"15%"}},[t._v("金额")]),t._v(" "),e("th",{attrs:{width:"15%"}},[t._v("奖金/状态")]),t._v(" "),t.orders.fristBuy?e("th",{attrs:{width:"13%"}},[t._v("操作")]):t._e()]),t._v(" "),t._l(t.orders.expect,function(s,i){return e("tr",{key:i},[e("td",{staticStyle:{"text-align":"left","padding-left":"2px"},attrs:{width:"22%"}},[t._v(t._s(s.expect))]),t._v(" "),e("td",{staticStyle:{"text-align":"left","padding-left":"2px","word-wrap":"break-word",width:"85px",display:"block",height:"auto",padding:"5px 0"},attrs:{width:"20%"}},[s.code.length?t._l(s.code,function(i,a){return e("em",{staticClass:"red"},[t._v(t._s(i)),a!==s.code.length-1?e("i",[t._v(",")]):t._e()])}):[t._v("--")]],2),t._v(" "),e("td",{attrs:{width:"10%"}},[t._v(t._s(s.multiple))]),t._v(" "),e("td",{attrs:{width:"15%"}},[t._v(t._s(t.orders.total_money/t.mulTotal*s.multiple)+t._s(t.lotteryUnit))]),t._v(" "),e("td",{attrs:{width:"15%"}},[0==s.newStatus?e("span",[t._v("未出票")]):t._e(),t._v(" "),1==s.newStatus?e("span",[t._v("已出票")]):t._e(),t._v(" "),2==s.newStatus?e("span",[s.bonus>0?e("b",{class:{red:s.bonus>0}},[t._v(t._s(s.bonus))]):e("em",[t._v("未中奖")])]):t._e(),t._v(" "),3==s.newStatus?e("span",[t._v("中奖停止")]):t._e(),t._v(" "),4==s.newStatus?e("span",[t._v("进行中")]):t._e(),t._v(" "),5==s.newStatus?e("span",[t._v("停止追号")]):t._e(),t._v(" "),6==s.newStatus?e("span",[t._v("流产撤单")]):t._e(),t._v(" "),7==s.newStatus?e("span",[t._v("系统撤单")]):t._e(),t._v(" "),8==s.newStatus?e("span",[t._v("用户撤单")]):t._e()]),t._v(" "),t.orders.fristBuy?e("td",{attrs:{width:"13%"}},[0==s.newStatus?[e("stop-chase",{attrs:{"lottery-id":t.orders.lottery_id,"order-id":t.orders.id,id:s.id},on:{"reload-expect":t.updateExpect}})]:[t._v("--")]],2):t._e()])})],2)])]),t._v(" "),e("div",{staticClass:"order-detail card border-bottom-1px"},[e("div",{staticClass:"title flex-box",class:{"border-bottom-1px":t.joinShow},on:{click:t.getJoinList}},[e("span",{staticClass:"join-title"},[t._v("参与用户")]),t._v(" "),e("em",[t._v("已有"),e("b",{staticClass:"red"},[t._v(t._s(t.orders.joinNum))]),t._v("人参与，共认购"),e("b",{staticClass:"red"},[t._v(t._s(t.orders.progress.buy_num))]),t._v("份")]),t._v(" "),e("span",{staticClass:"flex tr"},[e("i",{staticClass:"iconfont icon-xiajiantou c-3",class:{hide:!t.joinShow}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.joinShow,expression:"joinShow"}],staticClass:"c-3 chase-detail"},[e("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[t._m(0),t._v(" "),t._l(t.joinList,function(s,i){return e("tr",{key:i},[e("td",{staticStyle:{"text-align":"left","padding-left":"2px"},attrs:{width:"15%"}},[t.orders.fristBuy?e("em",[t._v(t._s(s.username))]):e("em",[t._v(t._s(s.username.substring(0,1))+"***")])]),t._v(" "),e("td",[e("em",{staticClass:"red"},[t._v(t._s(s.money))]),t._v("份 | "),e("em",{staticClass:"red"},[t._v(t._s(s.user_buy))]),t._v(t._s(t.lotteryUnit))]),t._v(" "),e("td",{attrs:{width:"20%"}},[t._v(t._s(s.bonus))]),t._v(" "),e("td",{attrs:{width:"35%"}},[t._v(t._s(s.create_time))])])})],2)])]),t._v(" "),e("div",{staticClass:"order-foot"},[e("p",[t._v("发起时间："+t._s(t.orders.create_time))]),t._v(" "),t.orders.ischase?e("p",[t._v("追号设置：\n                "),t.orders.is_stop?e("em",[t._v("中奖后停止追号")]):e("em",[t._v("中奖后继续追号")])]):t._e(),t._v(" "),e("p",[t._v("订单编号："+t._s(t.orders.lottery_id)+t._s(t.isGain))])])]),t._v(" "),t.loading?t._e():[e("div",{staticClass:"buy-grounp flex-box"},[t.orders.joinStatus&&100!==parseInt(t.orders.progress.progress)?[e("div",{staticClass:"f-sm c-4"},[t._v("剩余份数："),e("em",{staticClass:"f-large yellow"},[t._v(t._s(t.orders.progress.lost_num))]),t._v(" "),e("em",{staticClass:"c-3"},[t._v("份")])]),t._v(" "),e("div",{staticClass:"join-buy flex-box",staticStyle:{"justify-content":"flex-end"}},[e("input-number",{attrs:{max:t.orders.progress.lost_num,min:1,step:1},model:{value:t.value,callback:function(s){t.value=s},expression:"value"}}),t._v(" "),e("em",{staticClass:"f-mini c-3",staticStyle:{"margin-left":"5px"}},[t._v("份")]),t._v(" "),e("mt-button",{staticClass:"btn-buy",attrs:{type:"danger",size:"small"},nativeOn:{click:function(s){return t.submitOrder(s)}}},[t._v("购买")]),t._v(" "),e("mt-popup",{attrs:{position:"bottom"},model:{value:t.orderVisible,callback:function(s){t.orderVisible=s},expression:"orderVisible"}},[t.orderVisible?e("div",{staticClass:"orders-info"},[e("div",{staticClass:"order-title org border-bottom-1px"},[t._v("订单信息确认")]),t._v(" "),e("div",{staticClass:"order-info"},[e("div",[e("span",{staticClass:"name"},[t._v("投注彩种:")]),t._v(" "),e("span",{staticClass:"info"},[t._v(t._s(t.orders.title))])]),t._v(" "),e("div",[e("span",{staticClass:"name"},[t._v("投注方式:")]),t._v(" "),e("span",{staticClass:"info"},[t._v("参与合买")])]),t._v(" "),e("div",[e("span",{staticClass:"name"},[t._v("认购份数:")]),t._v(" "),e("span",{staticClass:"info"},[e("b",{staticClass:"red f-large"},[t._v(t._s(t.value))]),t._v("份 （共"),e("em",{staticClass:"red"},[t._v(t._s(t.buyMoney(t.value)))]),t._v(t._s(t.lotteryUnit)+"）")])]),t._v(" "),e("div",[e("span",{staticClass:"name"},[t._v("账户余额:")]),t._v(" "),e("span",{staticClass:"info"},[e("em",[t._v(t._s(t.money))]),t._v(" "+t._s(t.lotteryUnit))]),t._v(" "),t.money<t.buyMoney(t.value)?e("span",{staticClass:"tips tc",staticStyle:{"font-size":"14px",color:"#333"}},[e("b",{staticClass:"red"},[t._v("（余额不足，请充值!）")])]):t._e()])]),t._v(" "),e("div",{staticClass:"order-footer tr"},[e("mt-button",{staticClass:"cancel",attrs:{size:"small"},on:{click:function(s){t.orderVisible=!1}}},[t._v("取消")]),t._v(" "),t.money<t.buyMoney(t.value)?e("mt-button",{attrs:{type:"primary",size:"small"},on:{click:t.goPay}},[t._v("立即充值")]):e("mt-button",{attrs:{type:"primary",size:"small"},on:{click:t.payment}},[t.orderLoading?e("mt-spinner",{staticClass:"btn-loading",attrs:{slot:"icon",type:3,size:15,color:"#fff"},slot:"icon"}):t._e(),t._v("\n                                    确定购买\n                                ")],1)],1)]):t._e()])],1)]:t._e(),t._v(" "),t.orders.joinStatus&&100==parseInt(t.orders.progress.progress)?[e("mt-button",{staticClass:"disabled-btn",attrs:{size:"small",disabled:""}},[t._v("方案已满员")])]:t._e(),t._v(" "),7===t.orders.status_num||t.orders.joinStatus?t._e():[e("mt-button",{staticClass:"disabled-btn",attrs:{size:"small",disabled:""}},[t._v("合买已截止")])],t._v(" "),7!=t.orders.status_num||t.orders.joinStatus?t._e():[e("mt-button",{staticClass:"disabled-btn",attrs:{size:"small",disabled:""}},[t._v("系统撤单")])]],2)]],2)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("tr",[s("th",{staticStyle:{"text-align":"left","padding-left":"2px"},attrs:{width:"15%"}},[this._v("用户名")]),this._v(" "),s("th",[this._v("认购份数 | 总金额")]),this._v(" "),s("th",{attrs:{width:"20%"}},[this._v("奖金")]),this._v(" "),s("th",{attrs:{width:"35%"}},[this._v("认购时间")])])}]};var d=e("VU/8")(o,n,!1,function(t){e("h7du")},"data-v-4619a6d4",null);s.default=d.exports},VFnh:function(t,s,e){"use strict";var i={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{on:{click:this.showTips}},[s("mt-button",{staticClass:"stop-btn",attrs:{size:"small",type:"danger"}},[this._v("停止")])],1)},staticRenderFns:[]};var a=e("VU/8")({props:["lotteryId","id","orderId"],data:function(){return{}},computed:{},methods:{showTips:function(){var t=this;this.$messagebox.confirm("确定对该期停止追号吗？").then(function(){t.stopChase()}).catch(function(t){})},stopChase:function(){var t=this;this.$axios.post("/web/orders/stopLottery",{lottery_id:this.lotteryId,id:this.id}).then(function(s){var e=s.data;t.$toast(e.msg),t.$axios.post("/web/orders/reloadExpect",{lottery_id:t.lotteryId,id:t.orderId}).then(function(s){var e=s.data;t.$emit("reload-expect",e.data)})})}}},i,!1,function(t){e("cPwj")},"data-v-d9e484d2",null);s.a=a.exports},cPwj:function(t,s){},h7du:function(t,s){}});