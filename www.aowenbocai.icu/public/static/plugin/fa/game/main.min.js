var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),UserAction=function(){function t(){}return t.init=function(e){var n=e.info.betting;if(!Data.objEq(n,t.user_betting[e.info.userid])){t.user_betting[e.info.userid]||(t.user_betting[e.info.userid]={6:0,1:0,2:0});for(var i in n){var o=void 0;"1"==i?o=Main.bg_skin.da_group:"6"==i?o=Main.bg_skin.fa_group:"2"==i&&(o=Main.bg_skin.xiao_group);var r=0,a=0,s=0,d=0,h=n[i]-t.user_betting[e.info.userid][i];if(d=Math.floor(h/5e3),s=Math.floor(h%5e3/1e3),a=Math.floor(h%5e3%1e3/500),r=Math.floor(h%5e3%1e3%500/100))for(var c=0;r>c;c++)t.doBetting(o,e,"Code1Skin");if(a)for(var c=0;a>c;c++)t.doBetting(o,e,"Code2Skin");if(s)for(var c=0;s>c;c++)t.doBetting(o,e,"Code3Skin");if(d)for(var c=0;d>c;c++)t.doBetting(o,e,"Code4Skin")}t.user_betting[e.info.userid]={6:n[6],1:n[1],2:n[2]}}},t.doBetting=function(t,e,n){var i=new Code(n);i.scaleX=.4,i.scaleY=.4;var o;o=e.info.userid==Data.userid?Main.bg_skin.width/2-e.group.width/2:e.group.x,i.x=o+.32*i.width/2,i.y=e.group.y+.32*i.height/2,Main.bg_skin.betting_group.addChild(i);var r=Data.GetRandomNum(0,360),a=(Main.bg_skin.width-t.width)/2+24.5,s=t.y+Main.bg_skin.main_group.y,d=Data.GetRandomNum(a+.32*i.width/2,a+.8*t.width-.32*i.width/2),h=Data.GetRandomNum(s+.32*i.height/2,s+t.height-.32*i.height/2),c=egret.Tween.get(i);c.to({x:d,y:h,rotation:r,scaleX:.32,scaleY:.32},300),c.call(function(){Main.bg_skin.code_sound.play(0,1),i.bettingStatus()})},t.user_betting={},t}();__reflect(UserAction.prototype,"UserAction");var AllBg=function(){function t(){}return t.addAllBg=function(e){void 0===e&&(e=.7),t.all_bg=new egret.Shape,t.all_bg.graphics.beginFill(0),t.all_bg.width=Main.bg_skin.width,t.all_bg.height=Main.bg_skin.height,t.all_bg.graphics.drawRect(0,0,t.all_bg.width,t.all_bg.height),t.all_bg.graphics.endFill(),t.all_bg.alpha=.1,Main.bg_skin.addChild(t.all_bg);var n=egret.Tween.get(t.all_bg,{loop:!1});n.to({alpha:e},500)},t.removeAllBg=function(){egret.Tween.get(t.all_bg,{loop:!1});t.all_bg.parent.removeChild(t.all_bg)},t}();__reflect(AllBg.prototype,"AllBg");var Award=function(){function t(){this.is_winning={};var e=(new Date).getTime(),n=(Data.awardTime-e)/1e3;0>=n?this.getAwards():(t.timer=new egret.Timer(1e3,n),t.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),t.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),t.timer.start(),Main.bg_skin.betting_status=0),this.award_sound=RES.getRes("zhuan_mp3")}return t.prototype.timerFunc=function(){var e=(new Date).getTime(),n=parseInt(((Data.awardTime-e)/1e3).toString());if(0>=n)return t.timer.stop(),this.getAwards();if(4>n){var i=RES.getRes("win_mp3");i.play(0,1),Main.bg_skin.time_icon.alpha=1,this.setTime=setTimeout(function(){Main.bg_skin.time_icon.alpha=0},500)}Main.bg_skin.timeTxt.size=24,Main.bg_skin.timeTxt.text=n.toString()+' "'},t.prototype.timerComFunc=function(){this.getAwards()},t.prototype.startAnimation=function(){var e=this,n=Data.winning_num;Main.bg_skin.betting_status=2,Main.bg_skin.timeTxt.text="正在开奖",t.winning_bg.graphics.beginFill(16760473),t.winning_bg.graphics.drawRoundRect(0,0,68,48.5,20,20),t.winning_bg.graphics.endFill();for(var i=55+(11-n)+1,o=Main.bg_skin.num_group.$children,r=0,a=0,s=1;i>=s;s++)if(r+=s>50?150:50,this.setTime=setTimeout(function(){e.award_sound.play(0,1),o[a].addChildAt(t.winning_bg,1),a>=10?a=0:a++},r),s==i){for(var d=function(e){r+=180,h.setTime=setTimeout(function(){if(e%2==0)t.winning_bg.alpha=0;else{t.winning_bg.alpha=1;var n=RES.getRes("win_mp3");n.play(0,1)}},r)},h=this,c=1;7>=c;c++)d(c);this.setTime=setTimeout(function(){NumCode.deleteBg(),n>6?Main.bg_skin.da_group.$children[0].alpha=1:6>n?Main.bg_skin.xiao_group.$children[0].alpha=1:6==n&&(Main.bg_skin.fa_group.$children[0].alpha=1)},r),this.setTime=setTimeout(function(){if(e.is_winning.code){if(AllBg.addAllBg(.5),AllBg.all_bg.touchEnabled=!0,1==e.is_winning.code){var t=RES.getRes("more_code_mp3");t.play(0,1),e.success_group=new Success,Main.bg_skin.addChild(e.success_group),e.success_group.start(e.is_winning.bonus)}else 2==e.is_winning.code&&(e.success_group=new Fail,Main.bg_skin.addChild(e.success_group),e.success_group.start());Main.bg_skin.money.text=Data.user_money;var n=setTimeout(function(){e.InitGetNew()},3e3);AllBg.all_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){clearTimeout(n),this.InitGetNew()},e)}else Main.bg_skin.timeTxt.text="等待开启",Main.bg_skin.betting_status=3,Net.getNew()},r+1e3)}},t.awardInit=function(){var e=Data.winning_num;t.winning_bg.parent.removeChild(t.winning_bg),e>6?Main.bg_skin.da_group.$children[0].alpha=0:6>e?Main.bg_skin.xiao_group.$children[0].alpha=0:6==e&&(Main.bg_skin.fa_group.$children[0].alpha=0),Data.history_data.splice(0,0,{label:e});var n=new eui.ArrayCollection(Data.history_data);Main.bg_skin.history_data_group.dataProvider=n,Main.bg_skin.clearBetting(),Main.bg_skin.main_img.source="main_bg",Main.bg_skin.betting_status=0,UserAction.user_betting={},t.timer.start()},t.prototype.getAwards=function(){Main.bg_skin.clearCode(),Main.bg_skin.betting_status=1,Main.bg_skin.main_img.source="main_bg2",Main.bg_skin.timeTxt.text="已截止",Main.bg_skin.timeTxt.size=18,NumCode.setBg(),this.getNetAwards()},t.prototype.getNetAwards=function(){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open(Data.local_url+"fa/Index/getExpectCode",egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("expect="+Data.expect),t.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)},t.prototype.onPostComplete=function(t){var e=this,n=t.currentTarget,i=JSON.parse(n.response);if(i.code)this.is_winning=i.is_winning,Data.winning_num=i.num,Data.user_money=i.money,this.startAnimation();else{setTimeout(function(){e.getNetAwards()},1e3)}},t.prototype.onPostIOError=function(t){this.getNetAwards()},t.prototype.InitGetNew=function(){AllBg.removeAllBg(),AllBg.all_bg.touchEnabled=!1,this.success_group&&(this.success_group.parent.removeChild(this.success_group),this.success_group=""),Main.bg_skin.timeTxt.text="等待开启",Main.bg_skin.betting_status=3,Net.getNew()},t.winning_bg=new egret.Shape,t}();__reflect(Award.prototype,"Award");var createImg=function(){function t(){}return t.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},t}();__reflect(createImg.prototype,"createImg");var Data=function(){function t(){}return t.init=function(){t.local_url="http://"+location.host+"/"},Object.defineProperty(t,"coupon",{get:function(){return t._coupon},set:function(e){t._coupon=e,e>0?(Main.bg_skin.free_group.visible=!0,Main.bg_skin.code_group.visible=!1):(Main.bg_skin.free_group.visible=!1,Main.bg_skin.code_group.visible=!0),Main.bg_skin.free_num.text=e.toString()},enumerable:!0,configurable:!0}),t.GetRandomNum=function(t,e){var n=e-t,i=Math.random();return t+Math.round(i*n)},t.objEq=function(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;if(t.constructor!==e.constructor)return!1;for(var n in t)if(t.hasOwnProperty(n)){if(!e.hasOwnProperty(n))return!1;if(t[n]===e[n])continue;if("object"!=typeof t[n])return!1}for(n in e)if(e.hasOwnProperty(n)&&!t.hasOwnProperty(n))return!1;return!0},t.betting_code=[],t.betting_data=[],t.record_page=1,t.record_data=[],t.history_data=[],t.get_user_betting_start=!0,t.use_coupon=0,t.local_url="http://192.168.0.104:81/",t}();__reflect(Data.prototype,"Data");var HistoryRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!0,e.labelDisplay=new eui.Label,e.width=55,e.height=48.8,e.labelDisplay.width=55,e.labelDisplay.textAlign=egret.HorizontalAlign.CENTER,e.labelDisplay.height=48.8,e.addChild(e.labelDisplay),e}return __extends(e,t),e.prototype.dataChanged=function(){this.data.label<6?(this.data.label="小",this.labelDisplay.textColor=16693559):this.data.label>6?(this.data.label="大",this.labelDisplay.textColor=16745587):6==this.data.label?(this.data.label="發",this.labelDisplay.textColor=6604481):"小"==this.data.label?this.labelDisplay.textColor=16693559:"發"==this.data.label?this.labelDisplay.textColor=6604481:"大"==this.data.label&&(this.labelDisplay.textColor=16745587),this.labelDisplay.text=this.data.label},e}(eui.ItemRenderer);__reflect(HistoryRenderer.prototype,"HistoryRenderer");var Http=function(){function t(){}return t.get=function(t){var e=new egret.HttpRequest;return e.responseType=egret.HttpResponseType.TEXT,e.open(t,egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e},t}();__reflect(Http.prototype,"Http");var Loading=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.skinName="resource/eui_skins/Loading.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.height=this.stage.stageHeight,this.dispatchEventWith("childrenCreated")},e}(eui.Component);__reflect(Loading.prototype,"Loading",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.loading=new Loading,this.loading.percentWidth=100,this.addChild(this.loading),this.loading.addEventListener("childrenCreated",this.loadComplete,this)},e.prototype.loadComplete=function(){this.loading.bar.width=0,this.dispatchEventWith("loadComplete")},e.prototype.setProgress=function(t,e){this.loading.bar.percentWidth=100*t/e,this.loading.progress.text=t+"/"+e},e}(eui.Group);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e.code_select=0,e.betting_group=[],e.code_sub_group=[],e.code_group=[],e.money=0,e.TimeNum="30",e.allow_brtting=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading"),this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"loading"==t.groupName?(this.loadingView=new LoadingUI,this.loadingView.width=this.stage.stageWidth,this.loadingView.addEventListener("loadComplete",this.loadNext,this),this.stage.addChild(this.loadingView)):"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.loadNext=function(){RES.loadGroup("preload")},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){Data.init(),egret.ImageLoader.crossOrigin="anonymous";var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open(Data.local_url+"fa/Index/getInfo",egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this)},e.prototype.onPostComplete=function(t){e.bg_skin=new Bg;var n=this.stage.stageWidth,i=this.stage.stageHeight;e.bg_skin.width=n,e.bg_skin.height=i,this.addChild(e.bg_skin),this.stage.removeChild(this.loadingView),e.bg_sound=RES.getRes("bg_mp3"),this.iosSound()||e.bg_sound.play(0,0);var o=t.currentTarget,r=JSON.parse(o.response);Data.user_money=r.data.money,e.bg_skin.money.text=Data.user_money;var a=(new Date).getTime(),s=r.data.back_time?1e3*r.data.back_time:0;Data.awardTime=a+s,Data.expect=r.data.expect,Data.userid=r.data.id,Data.coupon=r.data.coupon,Data.coupon_coin=r.data.coupon_coin,UserAction.init({group:e.bg_skin.my_user,info:{userid:r.data.id,betting:r.data.betting_code}}),User.myUser(e.bg_skin.my_user,r.data);for(var d=0,h=r.data.history_code;d<h.length;d++){var c=h[d];Data.history_data.push({label:c.code})}Net.getUser()},e.prototype.iosSound=function(){var t=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return t?(e.bg_skin.$addListener(egret.TouchEvent.TOUCH_TAP,this.startSound,this),!0):!1},e.prototype.startSound=function(){e.bg_sound.play(0,0),e.bg_skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startSound,this)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Net=function(){function t(){}return t.getUser=function(){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(Data.local_url+"fa/Index/getRoomUser",egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.addEventListener(egret.Event.COMPLETE,t.userComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.userIOError,this)},t.userComplete=function(e){var n=e.currentTarget,i=JSON.parse(n.response);i.live?User.init(i.data.user_list,Main.bg_skin.user_group.$children):t.loginOut();setTimeout(function(){t.getUser()},5e3)},t.userIOError=function(e){setTimeout(function(){t.getUser()},1e3)},t.getNew=function(){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(Data.local_url+"fa/Index/getInitInfo",egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.addEventListener(egret.Event.COMPLETE,t.newComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.newIOError,this)},t.newComplete=function(e){var n=e.currentTarget,i=JSON.parse(n.response);if(i.code){var o=(new Date).getTime(),r=i.data.back_time?1e3*i.data.back_time:0;Data.awardTime=o+r,Data.expect=i.data.expect,Award.awardInit()}else{setTimeout(function(){t.getNew()},1e3)}},t.newIOError=function(e){setTimeout(function(){t.getNew()},1e3)},t.loginOut=function(){var t=new Alert;t.show("房间失去链接，点击重连！"),t.closeButton.$addListener(egret.TouchEvent.TOUCH_TAP,function(){window.location.reload()},this)},t}();__reflect(Net.prototype,"Net");var NumCode=function(){function t(){}return t.setBg=function(){for(var t=Main.bg_skin.num_group.$children,e=0,n=t;e<n.length;e++){var i=n[e];i.$children[0].alpha=1}},t.deleteBg=function(){for(var t=Main.bg_skin.num_group.$children,e=0,n=t;e<n.length;e++){var i=n[e];i.$children[0].alpha=0}},t}();__reflect(NumCode.prototype,"NumCode");var SuccessGroup=function(t){function e(e){var n=t.call(this)||this;return n.img=e,n.touchEnabled=!1,n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.show_img=(new createImg).createBitmapByName(this.img);var e=this.show_img.width,n=this.show_img.height;this.show_img.width=500,this.show_img.height=n*this.show_img.width/e,this.show_img.x=this.stage.stageWidth/2-250,this.show_img.y=100,this.show_img.alpha=0,this.addChild(this.show_img);var i=egret.Tween.get(this.show_img);i.to({x:this.stage.stageWidth/2-250,y:350,alpha:1},500,egret.Ease.backInOut),this.one_btn=(new createImg).createBitmapByName("one_btn"),this.one_btn.x=this.stage.stageWidth/2-125,this.one_btn.y=Main.bg_skin.height-100,this.one_btn.width=250,this.one_btn.alpha=0,this.addChild(this.one_btn);var o=egret.Tween.get(this.one_btn);o.to({x:this.stage.stageWidth/2-125,y:580,alpha:1},500,egret.Ease.backInOut),this.one_btn.touchEnabled=!1,this.show_img.touchEnabled=!1},e}(eui.Group);__reflect(SuccessGroup.prototype,"SuccessGroup");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function o(t){e.call(i,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var User=function(){function t(){}return t.init=function(e,n){var i=[],o=[];if(e.length)for(var r=0,a=e;r<a.length;r++){var s=a[r];s.userid!=Data.userid&&i.push(s.userid)}if(t.list)for(var d in t.list){var s=t.list[d];t.contains(i,s.info.userid)?o.push(s.info.userid):(t.removeUser(s.group),delete t.list[s.info.userid])}else;if(e.length)for(var h=0,c=e;h<c.length;h++){var s=c[h];s.userid!=Data.userid&&(t.contains(o,s.userid)?t.list[s.userid].info.betting=s.betting:t.list[s.userid]={group:t.getEmpty(n),info:{nickname:s.nickname,userid:s.userid,photo:s.photo,betting:s.betting}})}t.addUser()},t.myUser=function(e,n){var i=e.$children;t.addCommon(i,n)},t.addUser=function(){if(t.list)for(var e in t.list){var n=t.list[e];n.info.userid!=Data.userid&&(t.addCommon(n.group.$children,n.info),Data.get_user_betting_start&&UserAction.init(n))}},t.addCommon=function(t,e){t[4].text=e.nickname,t[3].source=Data.local_url+"index/Image/load?url="+e.photo+"&userid="+e.userid,t[3].mask=t[1],t[2].alpha=0},t.removeUser=function(t){var e=t.$children;e[4].text="空席",e[3].source="",e[3].mask=null,e[2].alpha=1},t.getEmpty=function(e){for(var n=0;6>n;n++)if(!t.contains(t.getHasGroup(),e[n]))return e[n]},t.getHasGroup=function(){var e=[];if(t.list){for(var n in t.list){var i=t.list[n];e.push(i.group)}return e}},t.contains=function(t,e){var n=t.findIndex(function(t){return t==e});return-1==n?!1:!0},t.removeArr=function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e){t.splice(n,1);break}},t.list={},t}();__reflect(User.prototype,"User");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?i(o):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DiamondsItem=function(t){function e(e){var n=t.call(this)||this;return n.data={money:"10",diamonds:"6"},n.data=e,n.skinName="DiamondsItemSkin",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.init,n),n}return __extends(e,t),e.prototype.init=function(){this.money.text="￥"+this.data.money+" 购买",this.diamonds.text=this.data.diamonds,this.award.text="额外赠送"+this.data.award+"金豆",this.money.addEventListener(egret.TouchEvent.TOUCH_TAP,this.go,this)},e.prototype.go=function(){window.top.location.href="/pay/pay/index/num/"+this.data.money+"/type/2"},e}(eui.Component);__reflect(DiamondsItem.prototype,"DiamondsItem");var PayItem=function(t){function e(e){var n=t.call(this)||this;return n.data={money:"10",award:"6",coin:"12"},n.data=e,n.skinName="PayItemSkin",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.init,n),n}return __extends(e,t),e.prototype.init=function(){var t=this;this.money.text="￥"+this.data.money+" 购买",this.coin.text=this.data.coin,this.award.text="额外赠送"+this.data.award+"金豆",this.money.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href="/pay/pay/index/num/"+t.data.money},this)},e}(eui.Component);__reflect(PayItem.prototype,"PayItem");var PayPanel=function(t){function e(){var e=t.call(this)||this;return e.host=Data.local_url,e.api="/index/Recharge/getRechargeList",e.userApi="/index/user/getInfo",e.content=[],e.api=e.host+e.api,e.userApi=e.host+e.userApi,e.skinName="PayPanelSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.no,e),e.auto_zh.addEventListener(eui.UIEvent.CHANGE,e.reload,e),e}return __extends(e,t),e.prototype.no=function(t){t.stopImmediatePropagation()},e.prototype.init=function(){var t=this;this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.close_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent&&t.parent.removeChild(t)},this)},e.prototype.reload=function(){Http.get(this.userApi).addEventListener(egret.Event.COMPLETE,this.setCoin,this),this.clearChild(),this.scroller.viewport.scrollV=0;var t=this.auto_zh.selected;t?(Http.get(this.api).addEventListener(egret.Event.COMPLETE,this.createList,this),this.title.text="充值金豆"):(Http.get(this.api).addEventListener(egret.Event.COMPLETE,this.diamondsList,this),this.title.text="充值钻石")},e.prototype.setCoin=function(t){var e=t.currentTarget,n=JSON.parse(e.response);n.err||(this.coin.text=n.data.money,this.diamonds.text=n.data.diamonds)},e.prototype.clearChild=function(){this.loading_group.visible=!0;var t=this.content;if(0!=t.length)for(var e=0,n=t;e<n.length;e++){var i=n[e];i.parent.removeChild(i)}this.content=[]},e.prototype.createList=function(t){var e=t.currentTarget,n=JSON.parse(e.response);if(!n.err){this.loading_group.visible=!1;for(var i=0,o=n.data;i<o.length;i++){var r=o[i],a=new PayItem(r);this.content.push(a),this.scroller_box.addChild(a)}}},e.prototype.diamondsList=function(t){var e=t.currentTarget,n=JSON.parse(e.response);if(!n.err){this.loading_group.visible=!1;for(var i=0,o=n.data;i<o.length;i++){var r=o[i],a=new DiamondsItem(r);this.content.push(a),this.scroller_box.addChild(a)}}},e}(eui.Component);__reflect(PayPanel.prototype,"PayPanel");var RecordItem=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.skinName="RecordItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.betting_money.text=this.data.betting_money,this.create_time.text=this.data.create_time,this.expect.text=this.data.expect,this.code.text="";var t="大";6==this.data.code?t="發":this.data.code<6&&(t="小"),0==this.data.status?(this.status.textColor=15933699,this.status.text="未开奖"):2==this.data.status?(this.status.textColor=16777215,this.status.text="未中奖",this.code.text="开奖："+this.data.code+"("+t+")"):7==this.data.status?(this.status.textColor=12369084,this.status.text="系统撤单",this.code.text="开奖："+this.data.code):(this.code.text="开奖："+this.data.code+"("+t+")",this.status.text="中奖："+this.data.bonus,this.status.textColor=14659875)},e}(eui.ItemRenderer);__reflect(RecordItem.prototype,"RecordItem");var RecordList=function(t){function e(){var e=t.call(this)||this;return e.current_page=0,e.last_page=1,e.s_isLoading=!1,e.skinName="RecordDataSkin",e.percentWidth=100,e.percentHeight=100,e.collection=new eui.ArrayCollection,e.list.dataProvider=e.collection,e.list.itemRenderer=RecordItem,e.list.selectedIndex=0,e.scroller.addEventListener(eui.UIEvent.CHANGE_END,e.loadData,e),e.loadData(),e}return __extends(e,t),e.prototype.reloadData=function(){var t=this;this.current_page=0,this.collection.removeAll(),this.scroller.viewport.scrollV=0,egret.setTimeout(function(){t.loadData()},this,100)},e.prototype.tag=function(){this.visible=!1},Object.defineProperty(e.prototype,"isLoading",{get:function(){return this.s_isLoading},set:function(t){t?this.tips.text="数据加载中...":this.tips.text="上拉加载更多"},enumerable:!0,configurable:!0}),e.prototype.loadData=function(){var t=this.scroller.viewport.scrollV-this.scroller.viewport.contentHeight+this.scroller.viewport.height;this.isLoading||0>t||this.current_page>=this.last_page||(this.isLoading=!0,this.current_page++,Http.get(Data.local_url+"fa/Index/getrecord?page="+this.current_page).addEventListener(egret.Event.COMPLETE,this.setData,this))},e.prototype.setData=function(t){this.isLoading=!1;var e=[],n=t.currentTarget,i=JSON.parse(n.response);if(i.data.length)for(var o=0,r=i.data;o<r.length;o++){var a=r[o];e.push({expect:a.expect,create_time:a.friend_time,betting_money:a.code_txt,bonus:a.bonus,status:a.status,code:a.winning_code})}this.current_page=i.current_page,this.last_page=i.last_page,this.current_page>=this.last_page&&(this.tips.text="所有数据加载完成");for(var s=0,d=e;s<d.length;s++){var h=d[s];this.collection.addItem(h)}},e}(eui.Component);__reflect(RecordList.prototype,"RecordList");var Alert=function(t){function e(){var e=t.call(this)||this;return e.skinName="AlertSkin",e.percentWidth=100,e.closeButton.$addListener(egret.TouchEvent.TOUCH_TAP,e.hide,e),e}return __extends(e,t),e.prototype.show=function(t){AllBg.addAllBg(.4),AllBg.all_bg.touchEnabled=!0,Main.bg_skin.addChild(this),this.content.text=t},e.prototype.hide=function(){AllBg.removeAllBg(),AllBg.all_bg.touchEnabled=!1,this.parent.removeChild(this)},e}(eui.Component);__reflect(Alert.prototype,"Alert");var Alert2=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.skinName="Alert2Skin",e}return __extends(e,t),e.prototype.show=function(t){var e=this;Main.bg_skin.addChild(this),this.content.text=t;setTimeout(function(){e.hide()},1e3)},e.prototype.hide=function(){this.parent.removeChild(this)},e}(eui.Component);__reflect(Alert2.prototype,"Alert2");var Article=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArticleSkin",e.percentWidth=100,e.close_btn.$addListener(egret.TouchEvent.TOUCH_TAP,e.hide,e),e.alpha=0,e}return __extends(e,t),e.prototype.recordShow=function(){this.title.text="投注记录",Data.record_page=1,Data.record_data=[];var t=new RecordList;this.article_box.addChild(t),Main.bg_skin.addChild(this);var e=egret.Tween.get(this,{loop:!1});e.to({alpha:1},500)},e.prototype.palyInfoShow=function(){this.title.text="玩法介绍";var t=new PlayInfo;t.setScrollerHeight(this.article_box.height),this.article_box.addChild(t),Main.bg_skin.addChild(this);var e=egret.Tween.get(this,{loop:!1});e.to({alpha:1},500)},e.prototype.hide=function(){var t=egret.Tween.get(this,{loop:!1});t.to({alpha:0},500),t.call(function(){Main.bg_skin.removeChild(this)})},e}(eui.Component);__reflect(Article.prototype,"Article");var Bg=function(t){function e(){var e=t.call(this)||this;return e.betting_status=3,e.skinName="MainBg",e.percentWidth=100,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.nav_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.navShow,this),this.xiao_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaoBettingDo,this),this.fa_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.faBettingDo,this),this.da_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.daBettingDo,this),this.clear_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clearCode,this),this.sub_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.subCode,this),this.cz_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.recharge,this);for(var t=this.code_group.numChildren,e=0;t>e;e++)0==e&&(this.code_group.getChildAt(e).selected=!0,this.code_num=100,this.code_select=this.code_group.getChildAt(e)),this.code_group.getChildAt(e).addEventListener(eui.UIEvent.CHANGE,this.toggleChangeHandler,this);this.nav_skin=new Nav;new Award;new NumCode,this.history(),this.code_sound=RES.getRes("more_code2_mp3")},e.prototype.recharge=function(){var t=new PayPanel;t.x=0,t.y=0,t.reload(),this.addChild(t)},e.prototype.toggleChangeHandler=function(t){var e=this.code_group.numChildren,n=t.$target;this.code_num=n.label,this.code_select=t.$target;for(var i=0;e>i;i++){var o=this.code_group.getChildAt(i);o.selected=o==t.target}},e.prototype.checkBetting=function(){if(1==this.betting_status){var t=new Alert2;return t.show("等待开奖,不能投注"),!1}if(2==this.betting_status){var t=new Alert2;return t.show("开奖中不能投注"),!1}if(3==this.betting_status){var t=new Alert2;return t.show("下一期未开始，不能投注"),!1}return!0},e.prototype.bettingDo=function(t,e){var n=this.checkBetting();if(n){if(!Data.coupon&&Data.use_coupon){var i=new Alert2;return void i.show("请确认免费券的下注")}if(this.checkMoney(this.code_num))if(this.sub_btn.currentState="up",Data.coupon){Data.coupon-=1,Data.use_coupon+=1;for(var o=Data.coupon_coin/100,r=0;o>r;r++)this.bettingAdd(t,e)}else this.bettingAdd(t,e)}},e.prototype.bettingAdd=function(t,e){var n=this,i=new Code(this.code_select.skinName);i.scaleX=.5,i.scaleY=.5,i.x=this.code_group.x+this.code_select.x+.7*i.width/2,i.y=this.code_group.y+.7*i.height/2,Data.betting_code.push(i),Data.betting_data.push({money:this.code_num,type:e}),this.betting_group.addChild(i);var o=Data.GetRandomNum(0,360),r=t.x+this.main_group.x,a=t.y+this.main_group.y,s=Data.GetRandomNum(r+.32*i.width/2,r+.8*t.width-.32*i.width/2),d=Data.GetRandomNum(a+.32*i.height/2,a+t.height-.32*i.height/2),h=egret.Tween.get(i);h.to({x:s,y:d,rotation:o,scaleX:.32,scaleY:.32},300),h.call(function(){n.code_sound.play(0,1)})},e.prototype.checkMoney=function(t){for(var e=0,n=0,i=Data.betting_data;n<i.length;n++){var o=i[n];e+=parseInt(o.money)}if(e+parseInt(t)>Data.user_money){this.recharge();var r=new Alert2;return r.show("余额不足，不能继续下注！"),!1}return!0},e.prototype.xiaoBettingDo=function(t){this.bettingDo(t.$currentTarget,2)},e.prototype.daBettingDo=function(t){this.bettingDo(t.$currentTarget,1)},e.prototype.faBettingDo=function(t){this.bettingDo(t.$currentTarget,6)},e.prototype.navShow=function(t){this.nav_skin.show(),AllBg.all_bg.touchEnabled=!0,AllBg.all_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.navHide,this)},e.prototype.navHide=function(t){AllBg.all_bg.touchEnabled=!1,this.nav_skin.hide()},e.prototype.history=function(){var t=new eui.ArrayCollection(Data.history_data);this.history_data_group.dataProvider=t,this.history_data_group.itemRenderer=HistoryRenderer},e.prototype.clearCode=function(){this.sub_btn.currentState="disabled";var t=Data.betting_code.length;if(t)for(var e=0,n=Data.betting_code;e<n.length;e++){var i=n[e];i.parent.removeChild(i)}Data.betting_code=[],Data.betting_data=[]},e.prototype.clearBetting=function(){var t=this.betting_group.$children,e=[];if(t.length){for(var n=0,i=t;n<i.length;n++){var o=i[n];e.push(o)}for(var r=0,a=e;r<a.length;r++){var o=a[r];o.parent.removeChild(o)}}Data.betting_code=[],Data.betting_data=[],UserAction.user_betting={}},e.prototype.subCode=function(){var t=this.checkBetting();if(t)if(this.sub_btn.currentState="disabled",Data.betting_code.length){var e=0;Data.use_coupon&&(e=1),Data.use_coupon=0;var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.open(Data.local_url+"fa/Index/addBetting",egret.HttpMethod.POST),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("code="+JSON.stringify(Data.betting_data)+"&is_coupon="+e),n.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)}else{this.sub_btn.currentState="disabled";var i=new Alert2;i.show("请先下注再确认提交！")}},e.prototype.onPostComplete=function(t){var e=t.currentTarget,n=JSON.parse(e.response);if(n.code){var i=new Alert2;
i.show("下注成功！");var o=Data.betting_code.length;if(o)for(var r=0,a=Data.betting_code;r<a.length;r++){var s=a[r];s.bettingStatus()}Data.betting_code=[],Data.betting_data=[],Data.user_money=n.money,Main.bg_skin.money.text=Data.user_money,Data.expect=n.expect}else{var i=new Alert2;i.show(n.msg)}},e.prototype.onPostIOError=function(t){var e=new Alert;e.show("网络数据错误！请重试")},e}(eui.Component);__reflect(Bg.prototype,"Bg");var Code=function(t){function e(e){var n=t.call(this)||this;return n.skinName=e,n.currentState="down",n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n}return __extends(e,t),e.prototype.bettingStatus=function(){this.code_bg.source="code",this.code_bg.bottom=-10,this.num.textColor=16354168,this.num_shadow.textColor=12672589},e}(eui.Component);__reflect(Code.prototype,"Code");var Fail=function(t){function e(){var e=t.call(this)||this;return e.skinName="FailSkin",e.percentWidth=100,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.start=function(){this.fail.play()},e}(eui.Component);__reflect(Fail.prototype,"Fail");var Nav=function(t){function e(){var e=t.call(this)||this;return e.skinName="NavSkin",e.play_info_nav.addEventListener(egret.TouchEvent.TOUCH_TAP,e.playInfo,e),e.record_nav.addEventListener(egret.TouchEvent.TOUCH_TAP,e.record,e),e.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.goHome,e),e}return __extends(e,t),e.prototype.playInfo=function(){var t=new Article;this.hide(),t.palyInfoShow()},e.prototype.show=function(){AllBg.addAllBg(),this.right=20,this.y=65,Main.bg_skin.addChild(this)},e.prototype.hide=function(){AllBg.removeAllBg(),Main.bg_skin.removeChild(this)},e.prototype.record=function(){var t=new Article;this.hide(),t.recordShow()},e.prototype.goHome=function(){window.top.location.href=Data.local_url},e}(eui.Component);__reflect(Nav.prototype,"Nav");var PlayInfo=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.skinName="PlayInfoSkin",e}return __extends(e,t),e.prototype.setScrollerHeight=function(t){this.scroller.height=t},e}(eui.Component);__reflect(PlayInfo.prototype,"PlayInfo");var Success=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuccessSkin",e.percentWidth=100,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.start=function(t){this.bonus.text=t,this.winning.play()},e}(eui.Component);__reflect(Success.prototype,"Success");