var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),PayPanel=function(t){function e(){var e=t.call(this)||this;return e.host="",e.api="/index/Recharge/getRechargeList",e.userApi="/index/user/getInfo",e.content=[],e.api=e.host+e.api,e.userApi=e.host+e.userApi,e.skinName="PayPanelSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.no,e),e.auto_zh.addEventListener(eui.UIEvent.CHANGE,e.reload,e),e}return __extends(e,t),e.prototype.no=function(t){t.stopImmediatePropagation()},e.prototype.init=function(){var t=this;this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.close_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent&&t.parent.removeChild(t)},this)},e.prototype.reload=function(){Http.get(this.userApi).addEventListener(egret.Event.COMPLETE,this.setCoin,this),this.clearChild(),this.scroller.viewport.scrollV=0;var t=this.auto_zh.selected;t?(Http.get(this.api).addEventListener(egret.Event.COMPLETE,this.createList,this),this.title.text="充值金豆"):(Http.get(this.api).addEventListener(egret.Event.COMPLETE,this.diamondsList,this),this.title.text="充值钻石")},e.prototype.setCoin=function(t){var e=t.currentTarget,i=JSON.parse(e.response);i.err||(this.coin.text=i.data.money,this.diamonds.text=i.data.diamonds)},e.prototype.clearChild=function(){this.loading_group.visible=!0;var t=this.content;if(0!=t.length)for(var e=0,i=t;e<i.length;e++){var n=i[e];n.parent.removeChild(n)}this.content=[]},e.prototype.createList=function(t){var e=t.currentTarget,i=JSON.parse(e.response);if(!i.err){this.loading_group.visible=!1;for(var n=0,o=i.data;n<o.length;n++){var s=o[n],r=new PayItem(s);this.content.push(r),this.scroller_box.addChild(r)}}},e.prototype.diamondsList=function(t){var e=t.currentTarget,i=JSON.parse(e.response);if(!i.err){this.loading_group.visible=!1;for(var n=0,o=i.data;n<o.length;n++){var s=o[n],r=new DiamondsItem(s);this.content.push(r),this.scroller_box.addChild(r)}}},e}(eui.Component);__reflect(PayPanel.prototype,"PayPanel");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Loading=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/LoadingSkin.exml",e}return __extends(e,t),e.prototype.init=function(){this.height=this.stage.stageHeight,this.dispatchEventWith("childrenCreated")},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.createChildren=function(){t.prototype.childrenCreated.call(this),this.height=this.stage.stageHeight,this.dispatchEventWith("childrenCreated")},e}(eui.Component);__reflect(Loading.prototype,"Loading");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.loading=new Loading,this.loading.addEventListener("childrenCreated",this.loadComplete,this),this.addChild(this.loading)},e.prototype.loadComplete=function(){this.loading.bar.width=0,this.dispatchEventWith("loadComplete")},e.prototype.setProgress=function(t,e){this.loading.bar.percentWidth=100*t/e,this.loading.progress.text=t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json?v=2","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json?v=2",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading"),this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"loading"==t.groupName?(this.loadingView=new LoadingUI,this.loadingView.addEventListener("loadComplete",this.loadNext,this),this.stage.addChild(this.loadingView)):"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.loadNext=function(){console.log("next"),RES.loadGroup("preload")},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){egret.ImageLoader.crossOrigin="anonymous",e.bg_skin=new GameUI,this.addChild(e.bg_skin),this.stage.removeChild(this.loadingView)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Data=function(){function t(){}return Object.defineProperty(t,"coupon",{get:function(){return t._coupon},set:function(e){t._coupon=e,e>0?(Main.bg_skin.btn_left.currentState="disabled",Main.bg_skin.btn_left.touchEnabled=!1,Main.bg_skin.btn_right.currentState="disabled",Main.bg_skin.btn_right.touchEnabled=!1,Main.bg_skin.bet_money.size=34,Main.bg_skin.bet_money.text="免费X"+e):(Main.bg_skin.btn_left.currentState="up",Main.bg_skin.btn_right.currentState="up",Main.bg_skin.btn_left.touchEnabled=!0,Main.bg_skin.btn_right.touchEnabled=!0,Main.bg_skin.bet_money.size=45,Main.bg_skin.bet_money.text=t.betMoneyList[t.betMoneyIndex].toString())},enumerable:!0,configurable:!0}),Object.defineProperty(t,"betMoney",{get:function(){return t.betMoneyList[t.betMoneyIndex]},enumerable:!0,configurable:!0}),t.ROOT_DONAME="http://"+location.host,t.GIFT_LIST_URL=t.ROOT_DONAME+"/zhuawawa/index/getList",t.GIFT_ZHUA_URL=t.ROOT_DONAME+"/zhuawawa/index/zhua",t.GIFT_HIS_LIST_URL=t.ROOT_DONAME+"/zhuawawa/index/getHisList",t.INIT_URL=t.ROOT_DONAME+"/zhuawawa/index/getInfo",t.betMoneyList=[200,500,1e3,2e3,5e3,1e4],t.betMoneyIndex=0,t.use_coupon=0,t}();__reflect(Data.prototype,"Data");var DiamondsItem=function(t){function e(e){var i=t.call(this)||this;return i.data={money:"10",diamonds:"6"},i.data=e,i.skinName="DiamondsItemSkin",i.addEventListener(egret.Event.ADDED_TO_STAGE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){this.money.text="￥"+this.data.money+" 购买",this.diamonds.text=this.data.diamonds,this.award.text="额外赠送"+this.data.award+"金豆",this.money.addEventListener(egret.TouchEvent.TOUCH_TAP,this.go,this)},e.prototype.go=function(){window.top.location.href="/pay/pay/index/num/"+this.data.money+"/type/2"},e}(eui.Component);__reflect(DiamondsItem.prototype,"DiamondsItem");var PayItem=function(t){function e(e){var i=t.call(this)||this;return i.data={money:"10",award:"6",coin:"12"},i.data=e,i.skinName="PayItemSkin",i.addEventListener(egret.Event.ADDED_TO_STAGE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){var t=this;this.money.text="￥"+this.data.money+" 购买",this.coin.text=this.data.coin,this.award.text="额外赠送"+this.data.award+"金豆",this.money.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href="/pay/pay/index/num/"+t.data.money},this)},e}(eui.Component);__reflect(PayItem.prototype,"PayItem");var Http=function(){function t(){}return t.get=function(t,e){if(e){var i=[];for(var n in e)i.push(n+"="+e[n]);t+="?"+i.join("&")}var o=new egret.HttpRequest;return o.responseType=egret.HttpResponseType.TEXT,o.open(t,egret.HttpMethod.GET),o.send(),o},t.prototype.onGetComplete=function(t){t.currentTarget},t}();__reflect(Http.prototype,"Http");var BetHisPanel=function(t){function e(){var e=t.call(this)||this;return e.current_page=0,e.last_page=1,e.s_isLoading=!1,e.skinName="BetHisPanelSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.percentHeight=100,this.collection=new eui.ArrayCollection,this.list.dataProvider=this.collection,this.list.itemRenderer=HisItem,this.list.itemRendererSkinName="HisItemSkin",this.list.selectedIndex=0,this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.loadData,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tag,this),this.reload.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reloadData,this),this.loadData()},e.prototype.reloadData=function(){var t=this;this.current_page=0,this.collection.removeAll(),this.scroller.viewport.scrollV=0,egret.setTimeout(function(){t.loadData()},this,100)},e.prototype.tag=function(){this.visible=!1},Object.defineProperty(e.prototype,"isLoading",{get:function(){return this.s_isLoading},set:function(t){t?this.tips.text="数据加载中...":this.tips.text="上拉加载更多"},enumerable:!0,configurable:!0}),e.prototype.loadData=function(){var t=this.scroller.viewport.scrollV-this.scroller.viewport.contentHeight+this.scroller.viewport.height;this.isLoading||0>t||this.current_page>=this.last_page||(this.isLoading=!0,this.current_page++,Http.get(Data.GIFT_HIS_LIST_URL+"?page="+this.current_page).addEventListener(egret.Event.COMPLETE,this.setData,this))},e.prototype.setData=function(t){this.isLoading=!1;var e=t.currentTarget,i=JSON.parse(e.response);this.current_page=i.current_page,this.last_page=i.last_page,this.current_page>=this.last_page&&(this.tips.text="所有数据加载完成");for(var n=0,o=i.data;n<o.length;n++){var s=o[n];this.collection.addItem(s)}},e}(eui.Component);__reflect(BetHisPanel.prototype,"BetHisPanel");var GameUI=function(t){function e(){var e=t.call(this)||this;return e.giftUp=!1,e.giftNet=!1,e.skinName="GameUISkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"money",{get:function(){return this.s_money},set:function(t){this.s_money=t,this.money_label.text=this.s_money.toString()},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.height=this.stage.stageHeight,this.go.addEventListener(egret.TouchEvent.TOUCH_TAP,this.zhua,this),this.jia.addEventListener("bottom",this.getGift,this),this.jia.addEventListener("isGet",function(){t.giftUp=!0,t.getGiftStatus()},this),this.btn_pay.addEventListener(egret.TouchEvent.TOUCH_TAP,this.recharge,this),this.btn_left.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.setBetMoney(0)},this),this.btn_right.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.setBetMoney(1)},this),this.menu_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hideMemu,this),this.menu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showMemu,this),this.game_his.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.his_panel.visible=!t.his_panel.visible},this),this.game_help.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.help_panel.visible=!t.his_panel.visible},this),this.home.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.top.location.href="/"},this),Http.get(Data.INIT_URL).addEventListener(egret.Event.COMPLETE,this.initMoney,this)},e.prototype.initMoney=function(t){var e=t.currentTarget,i=JSON.parse(e.response);this.money=i.data.money,Data.coupon=i.data.coupon,Data.coupon_coin=i.data.coupon_coin},e.prototype.showMemu=function(){this.menu_panel.visible=!0},e.prototype.hideMemu=function(){this.menu_panel.visible=!1},e.prototype.recharge=function(){var t=new PayPanel;t.x=0,t.y=0,t.reload(),this.addChild(t)},e.prototype.setBetMoney=function(t){Data.betMoneyIndex+=1==t?1:-1,Data.betMoneyIndex>Data.betMoneyList.length-1&&(Data.betMoneyIndex=0),Data.betMoneyIndex<0&&(Data.betMoneyIndex=Data.betMoneyList.length-1),this.gift_box.initCreateGift(),this.bet_money.text=Data.betMoneyList[Data.betMoneyIndex].toString()},e.prototype.zhua=function(){this.jia.isZhua||(Data.coupon>0?(this.jia.zhuaPlay(),Data.coupon-=1):this.money<Data.betMoneyList[Data.betMoneyIndex]?this.notMoney():(this.money-=Data.betMoneyList[Data.betMoneyIndex],this.jia.zhuaPlay()))},e.prototype.notMoney=function(){var t=new Sign;t.y=(this.stage.stageHeight-80)/2,t.x=(this.stage.stageWidth-t.width)/2,t.msg.text="余额不足！",this.addChild(t),egret.Tween.get(t).wait(1e3).to({alpha:0},500).call(function(){t.parent.removeChild(t)}),this.recharge()},e.prototype.getGift=function(){this.cache_gift=this.gift_box.getCenterGift(),this.jia.gift.addChild(this.cache_gift),Http.get(Data.GIFT_ZHUA_URL,{id:this.cache_gift.id}).addEventListener(egret.Event.COMPLETE,this.setGiftStatus,this)},e.prototype.setGiftStatus=function(t){var e=t.currentTarget,i=JSON.parse(e.response);this.isHitData=i,this.giftNet=!0,this.getGiftStatus()},e.prototype.getGiftStatus=function(){var t=this;if(this.giftUp&&this.giftNet){var e=new OverPlan;e.x=(this.stage.stageWidth-e.width)/2,this.isHitData.isHit?(this.money=this.isHitData.afterMoney,e.msg.text=this.isHitData.msg,e.y=(this.stage.stageHeight-e.height)/2,this.cache_gift.addEventListener("saveEnd",function(){e.gift_box.addChild(t.cache_gift),e.zhuan.play(),t.addChild(e),egret.Tween.get(e).wait(2e3).to({alpha:0},500).call(function(){e.parent.removeChild(e)})},this),this.cache_gift.save()):(e.y=(this.stage.stageHeight-80)/2,e.currentState="sign",this.cache_gift.lost(),egret.setTimeout(function(){t.addChild(e),egret.Tween.get(e).wait(1e3).to({alpha:0},500).call(function(){e.parent.removeChild(e)})},this,500)),this.giftUp=!1,this.giftNet=!1,this.isHitData=null}},e}(eui.Component);__reflect(GameUI.prototype,"GameUI");var Gift=function(t){function e(){var e=t.call(this)||this;return e.skinName="GiftSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){Http.get(Data.GIFT_LIST_URL).addEventListener(egret.Event.COMPLETE,this.initGift,this)},e.prototype.initGift=function(t){var i=t.currentTarget,n=JSON.parse(i.response);e.list=n.data,this.initCreateGift()},e.prototype.createGiftLoop=function(t){void 0===t&&(t=0);var i=e.list[Data.betMoney];i.length<=t&&(t=0);var n=i[t];this.createGift(n),this.setTimeoutIndex=egret.setTimeout(this.createGiftLoop,this,3500,t+1)},e.prototype.createGift=function(t){var e=new GiftItem;return e.title.text=t.title,e.id=t.id,this.gift_box.addChild(e),e},e.prototype.initCreateGift=function(){this.cleanChildren();for(var t=0,i=0;5>i;i++){var n=e.list[Data.betMoney];t=i%n.length;var o=n[t],s=this.createGift(o);s.x=i*s.width+0}this.setTimeoutIndex&&egret.clearTimeout(this.setTimeoutIndex),this.createGiftLoop(t)},e.prototype.cleanChildren=function(){for(var t=this.gift_box.numChildren-1;t>=0;t--){console.log(t);var e=this.gift_box.$children[t];e.stop(),e.parent.removeChild(e)}},e.prototype.getCenterGift=function(){var t=this.stage.stageWidth/2,e=this.gift_box.$children,i=[];e.forEach(function(e,n){i[n]=Math.abs(e.x+e.width/2-t)});var n,o=Math.min.apply(Math,i);return i.forEach(function(t,i){return t==o?void(n=e[i]):void 0}),n.stop(),n},e.betMoney=200,e}(eui.Component);__reflect(Gift.prototype,"Gift");var GiftItem=function(t){function e(){var e=t.call(this)||this;return e.speedX=2,e.isInit=!1,e.skinName="GiftItemSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.isInit||(this.isInit=!0,this.x=-this.width,this.addEventListener(egret.Event.ENTER_FRAME,this.run,this))},e.prototype.show=function(t){this.icon0.source=t,this.icon1.source=t},e.prototype.run=function(){this.x+=this.speedX,this.x>this.stage.stageWidth&&(this.removeEventListener(egret.Event.ENTER_FRAME,this.run,this),this.parent.removeChild(this))},e.prototype.stop=function(){this.x=0,this.removeEventListener(egret.Event.ENTER_FRAME,this.run,this)},e.prototype.lost=function(){var t=this;egret.Tween.get(this).to({y:2e3},2e3).call(function(){t.parent.removeChild(t)})},e.prototype.save=function(){var t=this;egret.Tween.get(this).to({y:-500},1e3).call(function(){t.y=0,t.dispatchEventWith("saveEnd")})},e}(eui.Component);__reflect(GiftItem.prototype,"GiftItem");var HelpPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="HelpPanelSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tag,this)},e.prototype.tag=function(){this.visible=!1},e}(eui.Component);__reflect(HelpPanel.prototype,"HelpPanel");var HisItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="HisItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.title.text=this.data.gift_info.title,this.bet_money.text=this.data.gift_info.bet_money,this.create_time.text=this.data.create_time.substr(0,16),this.is_hit_str.text=this.data.is_get?(this.is_hit_str.textColor=3735326,"夹中啦"):"未夹中"},e}(eui.ItemRenderer);__reflect(HisItem.prototype,"HisItem");var Jia=function(t){function e(){var e=t.call(this)||this;return e.isZhua=!1,e.skinName="JiaSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.height=this.stage.stageHeight},e.prototype.zhuaPlay=function(){var t=this;this.isZhua||(this.isZhua=!0,egret.setTimeout(function(){t.isZhua=!1},this,4250),egret.Tween.get(this.group).to({top:this.height-950-337},1500).to({top:this.height-850-337},750).call(function(){t.dispatchEventWith("bottom")}).wait(650).call(function(){egret.setTimeout(function(){t.dispatchEventWith("isGet")},t,1800)}).to({top:-437},2100),this.zhua.play(0))},e}(eui.Component);__reflect(Jia.prototype,"Jia");var OverPlan=function(t){function e(){var e=t.call(this)||this;return e.skinName="OverPlanSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){},e}(eui.Component);__reflect(OverPlan.prototype,"OverPlan");var Sign=function(t){function e(){var e=t.call(this)||this;return e.skinName="SignSkin",e}return __extends(e,t),e}(eui.Component);__reflect(Sign.prototype,"Sign");