var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,a){function s(t){try{h(o.next(t))}catch(e){a(e)}}function r(t){try{h(o["throw"](t))}catch(e){a(e)}}function h(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(s,r)}h((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return o([t,e])}}function o(i){if(n)throw new TypeError("Generator is already executing.");for(;h;)try{if(n=1,a&&(s=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,a=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(o){i=[6,o],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,a,s,r,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},Fight=function(t){function e(){var e=t.call(this)||this;return e.skinName="FightSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);__reflect(Fight.prototype,"Fight");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function o(o){e.call(i,o,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?o(n):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Http=function(){function t(){}return t.get=function(t,e){if(e){var i=[];for(var o in e)i.push(o+"="+e[o]);t+="?"+i.join("&")}var n=new egret.HttpRequest;return n.responseType=egret.HttpResponseType.TEXT,n.open(t,egret.HttpMethod.GET),n.send(),n},t.prototype.onGetComplete=function(t){t.currentTarget},t}();__reflect(Http.prototype,"Http");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="LoadingUISkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.omComplete()},e.prototype.omComplete=function(){this.height=this.stage.stageHeight,this.pro_bg.mask=this.rect_mask,this.playAnimation(this.load,!0)},e.prototype.onProgress=function(t,e){this.rect_mask.percentHeight=100*t/e;var i=Math.floor(t/e*100);this.loading.text="正在初始化。。。"+i+"%"},e.prototype.playAnimation=function(t,e){if(e)for(var i in t.items)t.items[i].props={loop:!0};t.play()},e}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadGroup("load",0)];case 3:return i.sent(),[4,RES.loadGroup("preload",1,t)];case 4:return i.sent(),this.stage.removeChild(t),[3,6];case 5:return e=i.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var o=new eui.Theme("resource/default.thm.json",t.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){Music.init(),Data.initURL(),"ios"==egret.Capabilities.os.toLowerCase()?this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.checkCookies,this):this.checkCookies();var t=new Game;this.addChild(t),Data.init(t)},e.prototype.checkCookies=function(){if(this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.checkCookies,this),Data.getCookies("music"))switch(Data.getCookies("music")){case"false":Music.PlayBGM();break;case"true":Music.StopBGM()}else Music.PlayBGM()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Music=function(){function t(){}return t.init=function(){t._click=RES.getRes("btn3_mp3"),t._back=RES.getRes("back_mp3"),t._wrong=RES.getRes("erro_mp3"),t._fight=RES.getRes("fight_mp3"),t._choose=RES.getRes("btn7_mp3"),t._bgm=RES.getRes("fightBGM_mp3"),t._win=RES.getRes("win~3_mp3"),t._lose=RES.getRes("lose_mp3")},t.PlayBGM=function(){t.IsMusic&&(t._bgm_channel=t._bgm.play(0,0))},t.StopBGM=function(){t._bgm_channel&&t._bgm_channel.stop(),t._click_channel&&t._click_channel.stop(),t._turn_channel&&t._turn_channel.stop()},t.PlayClick=function(){t.IsMusic&&(t._click_channel=t._click.play(0,1))},t.PlayWin=function(){t.IsMusic&&t._win.play(0,1)},t.PlayLose=function(){t.IsMusic&&t._lose.play(0,1)},t.PlayFight=function(){t.IsMusic&&(t._turn_channel=t._fight.play(0,1),egret.setTimeout(function(){t._turn_channel.stop()},this,2500))},t.PlayBack=function(){t.IsMusic&&t._back.play(0,1)},t.PlayWrong=function(){t.IsMusic&&t._wrong.play(0,1)},t.PlayChoose=function(){t.IsMusic&&t._choose.play(0,1)},Object.defineProperty(t,"IsMusic",{get:function(){var t=Data.getCookies("ismusic");return null==t||""==t?!0:"1"==t},set:function(e){e?(Data.setCookies("ismusic","1"),t.PlayBGM()):(Data.setCookies("ismusic","0"),t.StopBGM())},enumerable:!0,configurable:!0}),t}();__reflect(Music.prototype,"Music");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,o){function n(t){e.call(o,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(o))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(o,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Alert=function(t){function e(e){var i=t.call(this)||this;return i.skinName="AlertSkin",i.txt=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.addToStage,i),i}return __extends(e,t),e.prototype.addToStage=function(){this.height=this.stage.stageHeight,this.alert.text=this.txt,this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this._close,this)},e.prototype._close=function(){Music.PlayChoose(),this.parent.removeChild(this)},e}(eui.Component);__reflect(Alert.prototype,"Alert");var AutoGame=function(t){function e(){var e=t.call(this)||this;return e.autoIndex=0,e.skinName="AutoGameSkin",e.currentState="auto",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.createdChildren=function(){t.prototype.createChildren.call(this)},e.prototype.init=function(){this.height=this.stage.stageHeight;for(var t=0;3>t;t++)this["input"+t].textColor=13531449,this["input"+t].text="输入数量",this["input"+t].restrict="0-9";for(var t=0;4>t;t++)this["question"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.question,this);this.input2.text=Data.auto_soldier_number.toString(),this.auto_go.addEventListener(egret.TouchEvent.TOUCH_TAP,this._auto_go,this),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.back1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.join.addEventListener(egret.TouchEvent.TOUCH_TAP,this._jionRoom,this),this.createCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.createSure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.turnRoom,this);for(var e=0,i=this.auto_selected.$children;e<i.length;e++){var o=i[e];o.groupName="auto",o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.choose,this)}},e.prototype.turnRoom=function(){window.top.location.href=Data.PLAYROOM},e.prototype._jionRoom=function(){var t=this.joinRoom.text;Http.get(Data.JOIN_ROOM,{password:t}).addEventListener(egret.Event.COMPLETE,this.goToRoom,this)},e.prototype.goToRoom=function(t){var e=t.target,i=JSON.parse(e.response);return 0!=i.err?void this.addChild(new Alert("房间不存在或者密码错误!")):void(window.top.location.href=Data.PLAYROOM)},e.prototype.question=function(t){for(var e=t.target,i=0;4>i;i++)if(this["question"+i].hashCode==e.hashCode)switch(i){case 0:this.addChild(new Alert("当掠夺的金豆总数大于等于你设定的数量则退出自动战斗。"));break;case 1:this.addChild(new Alert("当被掠夺的金豆总数小于等于你设定的数量则退出自动战斗。"));break;case 2:this.addChild(new Alert("每局出兵的数量， 最大不超过1000000"));break;case 3:this.addChild(new Alert("随机：每局出战士兵随机选择。不随机：选择一种士兵，每局出战士兵则为你选择的士兵。"))}},e.prototype.choose=function(t){var e=t.target;switch(e.label){case"随机":this.autoIndex=0;break;case"矛兵":this.autoIndex=1;break;case"盾兵":this.autoIndex=2;break;case"弓兵":this.autoIndex=3}},e.prototype._auto_go=function(){return Music.PlayChoose(),Data.winMoney=Number(this.input0.text),Data.loseMoney=Number(this.input1.text),Data.auto_soldier_number=Number(this.input2.text),isNaN(Data.winMoney)||isNaN(Data.loseMoney)||isNaN(Data.auto_soldier_number)?void this.addChild(new Alert("请输入正确的金豆数量!")):Data.winMoney<=0||Data.loseMoney<=0||Data.auto_soldier_number<=0?void this.addChild(new Alert("请输入正确的金豆数量!")):Data.loseMoney>Data.money?void this.addChild(new Alert("你的粮草不足哦！!")):(this.dispatchEventWith("auto"),this.dispatchEventWith("auto_panel"),void(Data.nowMoney=Data.money))},e.prototype._back=function(){this.dispatchEventWith("auto_close"),this.parent.removeChild(this)},e}(eui.Component);__reflect(AutoGame.prototype,"AutoGame");var AutoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="AutoPanelSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(){this.height=this.stage.stageHeight,this.winMoney.text=Data.winMoney.toString(),this.loseMoney.text=Data.loseMoney.toString(),this.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this._cancel,this)},e.prototype._cancel=function(){this.dispatchEventWith("out_auto")},e}(eui.Component);__reflect(AutoPanel.prototype,"AutoPanel");var BetHistory=function(t){function e(){var e=t.call(this)||this;return e.isLoading=!0,e.skinName="BetHistorySkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.height=this.stage.stageHeight,Http.get(Data.GAMEHISTORY_URL).addEventListener(egret.Event.COMPLETE,this._history,this),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.back1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this)},e.prototype._history=function(t){this.isLoading=!1;var e=t.currentTarget,i=JSON.parse(e.response);if(i.data.data.length<=0)return this.scrollerList.parent.visible=!1,void(this.zero.visible=!0);Data.now_Page=Number(i.data.current_page),Data.all_Page=Number(i.data.last_page);var o=new eui.ArrayCollection;this.scrollerList.dataProvider=o,this.scrollerList.itemRenderer=BetItem;for(var n=0;n<i.data.data.length;n++)o.addItem(i.data.data[n]);this.collection=o,i.data.data.length<=7?this.loading.text="数据加载完成！":this.loading.text="正在加载中。。。",this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.move,this)},e.prototype.move=function(){var t=this.scroller.viewport.scrollV-(this.scroller.viewport.contentHeight-this.scroller.viewport.height);if(!(0>t)&&1!=this.isLoading){if(Data.now_Page++,Data.now_Page>Data.all_Page)return void(this.loading.text="这里是有底线的!");this.isLoading=!0,Http.get(Data.GAMEHISTORY_URL,{page:Data.now_Page}).addEventListener(egret.Event.COMPLETE,this.moreHistory,this)}},e.prototype.moreHistory=function(t){this.isLoading=!1;for(var e=t.currentTarget,i=JSON.parse(e.response),o=0;o<i.data.data.length;o++)this.collection.addItem(i.data.data[o])},e.prototype._back=function(){this.parent.removeChild(this)},e}(eui.Component);__reflect(BetHistory.prototype,"BetHistory");var BetItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.betting.text=this.data.betting+"兵",this.enemy_betting.text=this.data.enemy_betting+"兵",this.create_time.text=this.data.create_time,this.money.text="投注"+this.data.money+"金豆",0==this.data.status&&(this.result.text="挑战失败"),1==this.data.status&&(this.result.text="胜"+this.data.bonus+"金豆",this.result.textColor=14505517),2==this.data.status&&(this.result.text="平"+this.data.bonus+"金豆",this.result.textColor=14505517)},e}(eui.ItemRenderer);__reflect(BetItem.prototype,"BetItem");var Data=function(){function t(){}return t.initURL=function(){var e=RES.getRes("data_config_json");t.API_URL=e.API_URL,t.USER_INFO_URL=t.API_URL+"attack/index/getInfo",t.BET_URL=t.API_URL+"attack/index/addBettingNpc",t.CMPHISTORY_URL=t.API_URL+"attack/index/getHistoryCode",t.GAMEHISTORY_URL=t.API_URL+"attack/index/getNpcRecord",t.CREATE_ROOM=t.API_URL+"attack/index/createRoom",t.JOIN_ROOM=t.API_URL+"attack/index/joinRoom",t.PLAYROOM=t.API_URL+"attack/index/playIndex"},t.init=function(e){t.elem={gameMain:e}},Object.defineProperty(t,"coinCount",{get:function(){return Number(t.money)},set:function(e){t.money=e,t.elem.gameMain.recharge.text=e.toString()},enumerable:!0,configurable:!0}),t.setCookies=function(t,e){document.cookie=t+"="+e+";"},t.getCookies=function(t){for(var e=t+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){var n=i[o].trim();if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},t.API_URL="http://192.168.0.104:81/",t.USER_INFO_URL=t.API_URL+"attack/index/getInfo",t.BET_URL=t.API_URL+"attack/index/addBettingNpc",t.CMPHISTORY_URL=t.API_URL+"attack/index/getHistoryCode",t.GAMEHISTORY_URL=t.API_URL+"attack/index/getNpcRecord",t.CREATE_ROOM=t.API_URL+"attack/index/createRoom",t.JOIN_ROOM=t.API_URL+"attack/index/joinRoom",t.PLAYROOM=t.API_URL+"attack/index/playIndex",t.soldier=["矛","盾","弓","矛兵","盾兵","弓兵"],t.soldierImg=["sprite-game-soldier_json.sprite-game-soldier000","sprite-game-soldier_json.sprite-game-soldier002","sprite-game-soldier_json.sprite-game-soldier001","sprite-game-soldier_json.sprite-game-soldier005","sprite-game-soldier_json.sprite-game-soldier004","sprite-game-soldier_json.sprite-game-soldier003"],t.winImg=["sprite-bubble-title_json.sprite-bubble-title000","sprite-bubble-title_json.sprite-bubble-title007","sprite-bubble-title_json.sprite-bubble-title008"],t.money=0,t.bouns=0,t.buttons=[0,100,1e3,1e4],t.bet=100,t.code=0,t.soldiersGroup=[],t.cmpSoldierY=0,t.youSoldierY=0,t.imgXy={x:35,y:654},t.source=0,t.betSource=0,t.status=0,t.now_Page=1,t.all_Page=1,t.auto_soldier_number=1e3,t.winMoney=0,t.loseMoney=0,t.nowMoney=0,t.auto_source=0,t}();__reflect(Data.prototype,"Data");var Game=function(t){function e(){var e=t.call(this)||this;return e.isAuto=!1,e.winMoney=0,e.loseMoney=0,e.skinName="GameUiSkin",e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.percentHeight=100,this.percentWidth=100,this.init(),Http.get(Data.CMPHISTORY_URL).addEventListener(egret.Event.COMPLETE,this.initPanel,this),this.payBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this._payBack,this),this.payBack2.addEventListener(egret.TouchEvent.TOUCH_TAP,this._payBack,this),this.Panel.addEventListener(egret.TouchEvent.TOUCH_TAP,this._panel,this),this.active.addEventListener(egret.TouchEvent.TOUCH_TAP,this._active,this),this.award.addEventListener(egret.TouchEvent.TOUCH_TAP,this._award,this),this.set.addEventListener(egret.TouchEvent.TOUCH_TAP,this._set,this),this.recharge.parent.addEventListener(egret.TouchEvent.TOUCH_TAP,this._recharge,this),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.soldiers.soldierBack,this.soldiers),this.auto_fight.addEventListener(egret.TouchEvent.TOUCH_TAP,this._auto_fight,this),this.soldiers.addEventListener("fight",this._fight,this),this.soldiers.addEventListener("pay",this._recharge,this),this.soldiers.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.help.visible=!1},this),this.back.getChildAt(1).touchEnabled=!1,this.createRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this._createRoom,this),this.JionRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this._jionRoom,this)},e.prototype.init=function(){Http.get(Data.USER_INFO_URL).addEventListener(egret.Event.COMPLETE,this._setMoney,this);for(var t=0,e=0,i=this.btns.$children;e<i.length;e++){var o=i[e];if(t++,o.label=Data.buttons[t].toString(),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnTouch,this),Data.getCookies("btn")){var n=Data.getCookies("btn");n==o.label&&(o.selected=!0,Data.bet=Number(o.label))}else{var a=this.btns.$children[0];a.selected=!0}}},e.prototype._setMoney=function(t){var e=t.currentTarget,i=JSON.parse(e.response);Data.money=Math.floor(i.money),this.recharge.text=Data.money.toString()},e.prototype._auto_fight=function(){var t=this;if(Music.PlayChoose(),1==this.auto_fight.selected){var e=new AutoGame;e.currentState="auto",e.addEventListener("auto_close",function(){t.auto_fight.selected=!1},this),e.addEventListener("auto",function(){t.help.visible=!1,t.auto_fight.touchEnabled=!1,t.soldiers.touchChildren=!1,t.isAuto=!0,t.autoIndex=e.autoIndex,t.auto_game(),e.parent.removeChild(e)},this),e.addEventListener("auto_panel",this.auto_panel,this),this.addChild(e)}},e.prototype.auto_panel=function(){var t=this,e=new AutoPanel;e.NowLoseMoney.text="0",e.NowWinMoney.text="0",this.stage.addChild(e),e.addEventListener("out_auto",function(){1!=t.isAuto&&(e.parent.removeChild(e),t.out_auto_game())},this),this._auto_panel=e},e.prototype.auto_game=function(){var t=this,e=egret.setTimeout(function(){var e=Math.floor(3*Math.random());0==t.autoIndex?Data.auto_source=e+1:Data.auto_source=t.autoIndex,Data.code=Data.auto_soldier_number,Http.get(Data.BET_URL,{betting:Data.auto_source,money:Data.code}).addEventListener(egret.Event.COMPLETE,t.betAfter,t),Data.money-=Data.auto_soldier_number,Data.coinCount=Data.money,t._fight(),t.auto_game()},this,6e3);this.auto=e},e.prototype.betAfter=function(t){var e=t.target,i=JSON.parse(e.response);0==i.err&&(Data.bouns=i.bonus,Data.betSource=Number(i.enemy_betting),Data.money=Math.floor(i.money),Data.status=i.status,this.setMoney())},e.prototype.setMoney=function(){var t=Data.bouns-Data.auto_soldier_number;t>0?(Data.winMoney-=t,this.winMoney+=t):(Data.loseMoney+=t,this.loseMoney+=t),(Data.loseMoney<=0||Data.winMoney<=0)&&this.out_auto_game(),Data.money<=0&&this.out_auto_game()},e.prototype.out_auto_game=function(){var t=this;egret.setTimeout(function(){t.auto_fight.selected=!1,t.auto_fight.touchEnabled=!0,t._auto_panel&&t._auto_panel.parent&&(t.stage.removeChild(t._auto_panel),t.winMoney=0,t.loseMoney=0)},this,7e3),this.soldiers.touchChildren=!0,egret.clearTimeout(this.auto)},e.prototype._createRoom=function(){var t=this;this.alert.parent.visible=!0,this.alertSure.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Http.get(Data.CREATE_ROOM).addEventListener(egret.Event.COMPLETE,t.showPassword,t)},this),this.alertCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.alert.parent.visible=!1},this)},e.prototype._jionRoom=function(){var t=new AutoGame;t.currentState="joinRoom",this.addChild(t)},e.prototype.showPassword=function(t){var e=this,i=t.target,o=JSON.parse(i.response);if(0!=o.err)return void this.addChild(new Alert("创建失败！"));var n=new AutoGame;n.currentState="createRoom",n.addEventListener("auto_close",function(){e.alert.parent.visible=!1},this),this.addChild(n),n.room.text=o.password},e.prototype.btnTouch=function(t){Music.PlayChoose(),this.help.visible=!1;var e=t.target;Data.bet=Number(e.label),Data.setCookies("btn",e.label)},e.prototype._recharge=function(){Music.PlayChoose(),this.payGroup.visible=!0,this.pay.stop(),this.pay.play(),this.payPanel.reload()},e.prototype._payBack=function(){this.payGroup.visible=!1},e.prototype._active=function(){Music.PlayChoose()},e.prototype._award=function(){Music.PlayChoose()},e.prototype._set=function(){Music.PlayChoose();var t=new SetPanel;this.addChild(t)},e.prototype._fight=function(){this.auto_fight.touchEnabled=!1,Data.cmpSoldierY=this.cityImg.localToGlobal().y+this.cityImg.height,Data.youSoldierY=this.soldiers.localToGlobal().y+50,this.resdImg()},e.prototype.resdImg=function(){var t=new eui.Image;t.source="sprite-game_json.sprite-game011",t.x=this.stage.stageWidth-100,t.y=(this.stage.stageHeight-t.height)/2-50,this.addChild(t),Data.imgXy={x:t.x,y:t.y};var e=egret.Tween.get(t),i=(this.stage.stageWidth-t.width)/2;e.to({x:i},750).call(this._result,this).call(function(){t.parent.removeChild(t)},this)},e.prototype._result=function(){this.soldiers.visible=!1;var t=new Reulst;t.x=(this.stage.stageWidth-t.width)/2,t.y=(this.stage.stageHeight-t.height)/2,this.addChild(t),t.addEventListener("newGame",this.newGame,this)},e.prototype.newGame=function(){this._auto_panel&&(this._auto_panel.NowWinMoney.text=this.winMoney.toString(),this._auto_panel.NowLoseMoney.text=this.loseMoney.toString()),this.soldiers.visible=!0,this.auto_fight.touchEnabled=!0,this.soldiers.soldierBack(),this.isAuto=!1,Http.get(Data.CMPHISTORY_URL).addEventListener(egret.Event.COMPLETE,this.initPanel,this)},e.prototype._panel=function(){Music.PlayChoose();var t=new HistoryPanel;t.currentState="history",this.addChild(t)},e.prototype.initPanel=function(t){var e=t.currentTarget,i=JSON.parse(e.response);if(!(i.data.data.length<=0))if(this.Panel.removeChildren(),i.data.data.length>3)for(var o=0;3>o;o++){var n=new Historys;n.txt.text=i.data.data[o].enemy_betting,this.Panel.addChild(n)}else for(var o=0;o<i.data.data.length;o++){var n=new Historys;n.txt.text=i.data.data[o].enemy_betting,this.Panel.addChild(n)}},e}(eui.Component);__reflect(Game.prototype,"Game");var HistoryPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="HistoryPanelSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.height=this.stage.stageHeight,this.history(),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.back1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this),this.back2.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this)},e.prototype.history=function(){"history"==this.currentState&&Http.get(Data.CMPHISTORY_URL).addEventListener(egret.Event.COMPLETE,this._history,this)},e.prototype._history=function(t){var e=t.currentTarget,i=JSON.parse(e.response);return i.data.data.length<=0?void(this.zero.visible=!0):(Data.cmpHistory=i.data.data,void this.init())},e.prototype.init=function(){var t=new eui.ArrayCollection;if(this.scrollerList.dataProvider=t,this.scrollerList.itemRenderer=Item,!(Data.cmpHistory.length<=0))for(var e=0;e<Data.cmpHistory.length;e++)t.addItem({time:Data.cmpHistory[e].create_time,soldier:Data.cmpHistory[e].enemy_betting})},e.prototype._back=function(){this.parent.removeChild(this)},e}(eui.Component);__reflect(HistoryPanel.prototype,"HistoryPanel");var Historys=function(t){function e(){var e=t.call(this)||this;return e.skinName="HistorySkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(){},e}(eui.Component);__reflect(Historys.prototype,"Historys");var Home=function(t){function e(){var e=t.call(this)||this;return e.skinName="HomeSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=this.rec.width/this.img.width,i=this.rec.height/this.img.height;this.img.scaleX=e,this.img.scaleY=i,this.img.mask=this.rec,this.text.filters=[this.filter()]},e.prototype.filter=function(){var t=16711680,e=.8,i=35,o=35,n=2,a=3,s=!1,r=!1,h=new egret.GlowFilter(t,e,i,o,n,a,s,r);return h},e.prototype.msfilter=function(){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return e},e}(eui.Component);__reflect(Home.prototype,"Home");var Item=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.time.text=this.data.time,this.soldier.text=this.data.soldier+"兵"},e}(eui.ItemRenderer);__reflect(Item.prototype,"Item");var Reulst=function(t){function e(){var e=t.call(this)||this;return e.skinName="ResultSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.height=this.stage.stageHeight,this.changeSoldier()},e.prototype.changeSoldier=function(){this.cmp.y=Data.cmpSoldierY,this.cmp.s_name.y=-20,this.cmp.life.parent.y=-40,this.cmp.soldier.source=Data.soldierImg[Data.betSource+2],this.cmp.s_name.text=Data.soldier[Data.betSource+2]+" x "+Data.code,Data.auto_source>0?(this.you.y=Data.youSoldierY,this.you.soldier.source=Data.soldierImg[Data.auto_source+2],this.you.s_name.text=Data.soldier[Data.auto_source+2]+" x "+Data.code):(this.you.y=Data.youSoldierY,this.you.soldier.source=Data.soldierImg[Data.source],this.you.s_name.text=Data.soldier[Data.source]+" x "+Data.code),this._soldier()},e.prototype._soldier=function(){var t=this;Music.PlayFight();var e=egret.Tween.get(this.cmp).to({y:Data.cmpSoldierY}).call(function(){t.cmp.visible=!0},this),i=egret.Tween.get(this.you).to({y:Data.youSoldierY}).call(function(){t.you.visible=!0},this);e.to({y:Data.imgXy.y},500).call(function(){t.cmp.soldier.visible=!1,t.you.soldier.visible=!1},this).call(this.result,this),i.to({y:Data.imgXy.y},400)},e.prototype._fight=function(){var t=this;this.fightGroup.visible=!0,this.fight.stop(),this.fight.play(),this.fight.addEventListener("complete",function(){t.parent.removeChild(t)},this)},e.prototype.showResult=function(){var t=this,e=new ShowResult;this.stage.addChild(e),this._showResult=e,e.addEventListener("newGame",this.newGame,this),egret.Tween.get(e).to({alpha:1},1e3).wait(1200).call(function(){t.newGame(),e.parent.removeChild(e)},this)},e.prototype.newGame=function(){this.dispatchEventWith("newGame")},e.prototype.draw=function(){var t=this;this._fight(),this.cmp._loseHarf(),this.you._loseHarf(),egret.setTimeout(function(){t.showResult(),Music.PlayWin(),t._showResult.giftImg.source=Data.winImg[2],t._showResult.gift.text=Data.bouns.toString(),t._showResult.currentState="win",Data.coinCount=Data.money},this,2e3)},e.prototype.win=function(){var t=this;this._fight(),this.cmp._loseAll(),egret.setTimeout(function(){t.showResult(),Music.PlayWin(),t._showResult.giftImg.source=Data.winImg[0],t._showResult.gift.text=Data.bouns.toString(),t._showResult.currentState="win",Data.coinCount=Data.money},this,2e3)},e.prototype.lose=function(){var t=this;this._fight(),this.you._loseAll(),egret.setTimeout(function(){t.showResult(),Music.PlayLose(),t._showResult.giftImg.source=Data.winImg[1],t._showResult.currentState="lose"},this,2e3)},e.prototype.result=function(){0==Data.status&&this.lose(),1==Data.status&&this.win(),2==Data.status&&this.draw()},e}(eui.Component);__reflect(Reulst.prototype,"Reulst");var SetPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="SetPanelSkin",e}return __extends(e,t),e.prototype.createChildren=function(){if(t.prototype.createChildren.call(this),Data.getCookies("music")){var e="true"==Data.getCookies("music")?!0:!1;this.sound.selected=e}this.height=this.stage.stageHeight,this.sound.addEventListener(eui.UIEvent.CHANGE,this._sound,this),this.betHistory.addEventListener(egret.TouchEvent.TOUCH_TAP,this._betHistory,this),this.backHome.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backHome,this),this.help.addEventListener(egret.TouchEvent.TOUCH_TAP,this._help,this),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this)},e.prototype._sound=function(t){1==t.target.selected?(Data.setCookies("music",!0),Music.StopBGM(),Music.IsMusic=!1):(Data.setCookies("music",!1),Music.IsMusic=!0)},e.prototype._betHistory=function(){Music.PlayChoose();var t=new BetHistory;this.stage.addChild(t)},e.prototype._backHome=function(){Music.PlayChoose(),window.location.href="/"},e.prototype._help=function(){Music.PlayChoose();var t=new HistoryPanel;t.currentState="help",this.addChild(t)},e.prototype._back=function(){Music.PlayChoose(),this.parent.removeChild(this)},e}(eui.Component);__reflect(SetPanel.prototype,"SetPanel");var ShowResult=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShowResultSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.height=this.stage.stageHeight,this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._back,this)},e.prototype._back=function(){this.dispatchEventWith("newGame"),egret.Tween.removeTweens(this),this.parent.removeChild(this)},e}(eui.Component);__reflect(ShowResult.prototype,"ShowResult");var Soldier=function(t){function e(){var e=t.call(this)||this;return e.s_type=0,e.bet=0,e.soldierGo=!1,e.skinName="SoldierSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setSource=function(){var t=this.soldierGo?this.soldierType+3:this.soldierType;this.soldier.source=Data.soldierImg[t],Data.source=t},e.prototype.setSoldierGo=function(){this.soldierGo=!0,this.bet+=Data.bet,this.s_name.text=Data.soldier[this.soldierType+3]+"x"+this.bet,this.setSource()},Object.defineProperty(e.prototype,"soldierType",{get:function(){return this.s_type},set:function(t){this.s_type=t,this.setSource()},enumerable:!0,configurable:!0}),e.prototype.soldierBack=function(){this.soldierGo=!1,this.bet=0,this.s_name.text=Data.soldier[this.soldierType+3],this.setSource()},e.prototype._loseHarf=function(){this.loseHarf.stop(),this.loseHarf.play()},e.prototype._loseAll=function(){this.loseAll.stop(),this.loseAll.play()},e}(eui.Component);__reflect(Soldier.prototype,"Soldier");var SoldierGroup=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),Data.soldiersGroup=[this.soldier0,this.soldier1,this.soldier2];for(var e=0,i=0,o=Data.soldiersGroup;i<o.length;i++){var n=o[i];e++,n.s_name.text=Data.soldier[e+2],n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setSoldierGo,this)}this.fight.addEventListener(egret.TouchEvent.TOUCH_TAP,this._fight,this)},e.prototype.betAfter=function(t){var e=t.currentTarget,i=JSON.parse(e.response);0==i.err&&(Data.bouns=i.bonus,Data.betSource=Number(i.enemy_betting),Data.money=Math.floor(i.money),Data.status=i.status)},e.prototype._fight=function(){return Music.PlayChoose(),Data.code>Data.money?void this.dispatchEventWith("pay"):(Http.get(Data.BET_URL,{betting:Data.source-2,money:Data.code}).addEventListener(egret.Event.COMPLETE,this.betAfter,this),Data.money-=Data.code,Data.coinCount=Data.money,this.dispatchEventWith("fight"),void(this.fight.visible=!1))
},e.prototype.setSoldierGo=function(t){Music.PlayChoose(),this.fight.visible=!0;var e=t.currentTarget;if(!e.soldierGo){for(var i=0,o=Data.soldiersGroup;i<o.length;i++){var n=o[i];n.alpha=.5,n.soldierBack()}e.alpha=1}e.setSoldierGo(),Data.code=e.bet},e.prototype.soldierBack=function(){this.fight.visible=!1;for(var t=0,e=Data.soldiersGroup;t<e.length;t++){var i=e[t];i.alpha=1,i.soldierBack()}},e}(eui.Component);__reflect(SoldierGroup.prototype,"SoldierGroup");var PayItem=function(t){function e(e){var i=t.call(this)||this;return i.data={money:"10",award:"6",coin:"12",flower:"12"},i.data=e,i.skinName="PayItemSkin",i.addEventListener(egret.Event.ADDED_TO_STAGE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){this.money.text="￥"+this.data.money+" 购买",this.award.text=this.data.award,this.coin.text=this.data.coin,this.flower.text=this.data.flower,this.money.addEventListener(egret.TouchEvent.TOUCH_TAP,this.go,this)},e.prototype.go=function(){window.top.location.href="/pay/pay/index/num/"+this.data.money},e}(eui.Component);__reflect(PayItem.prototype,"PayItem");var PayPanel=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.host="",i.api="/index/Recharge/getRechargeList",i.userApi="/index/user/getInfo",i.api=i.host+i.api,i.userApi=i.host+i.userApi,i.skinName="PayPanelSkin",i.addEventListener(egret.Event.ADDED_TO_STAGE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){Http.get(this.api).addEventListener(egret.Event.COMPLETE,this.createList,this)},e.prototype.reload=function(){Http.get(this.userApi).addEventListener(egret.Event.COMPLETE,this.setCoin,this)},e.prototype.setCoin=function(t){var e=t.currentTarget,i=JSON.parse(e.response);i.err||(this.coin.text=i.data.money,this.flower.text=i.data.flower)},e.prototype.createList=function(t){var e=t.currentTarget,i=JSON.parse(e.response);if(!i.err)for(var o=0,n=i.data;o<n.length;o++){var a=n[o];this.scroller_box.addChild(new PayItem(a))}},e}(eui.Component);__reflect(PayPanel.prototype,"PayPanel");