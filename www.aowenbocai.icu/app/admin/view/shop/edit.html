{include file='common/head' /}
<script src="__STATIC__/js/reszieimg.js"></script>
<style media="screen">
    .form{
      margin:20px;
      width: 400px;
    }
  .form textarea{
    width: 100%;
    height: 7rem;
  }
</style>
<nav class="plugin_nav">
  <a class="nav_active" href="{:url('admin/Shop/index')}">商品管理</a>
  <a href="{:url('admin/ShopOrder/index')}">订单管理</a>
  <a href="{:url('admin/shop/shopNav')}">分类管理</a>
  <a href="{:url('admin/shop/add')}">添加商品</a>
</nav>
<div class="box-padding">
<ol class="breadcrumb">
  <li><i class="glyphicon glyphicon-link"></i> <a href="{:url('index')}">兑换商城</a></li>
  <li class="active">商品修改</li>
</ol>
<div id="app">
  <div>
    <form class="form" action="{:url('edit')}" method="post">
      <input type="file" class="hidden select_photo">
      <input type="hidden" name="id" value="{$info.id}"  >
      <div class="form-group">
        <label>商品名</label>
        <input type="text" class="form-control" placeholder="输入商品名" name="name" value="{$info.name}">
      </div>
      <div class="form-group">
        <label>商品类型</label>
        <input type="hidden" name="type" value="{$info.typeNum}">
        <div class="dropdown" style="display:inline-block">
            <button type="button" class="btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown"><span class="typename">{$info.type}</span>
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
              {volist name="$nav" id="item"}
                <li role="presentation"  class="typeSelect">
                    <a role="menuitem" tabindex="-1" data-id="{$item.id}">{$item.name}</a>
                </li>
              {/volist}
            </ul>
        </div>
      </div>
      <div class="form-group" style="height: 80px;">
        <label>封面图片</label>
        <span class="user_r_text" style="height: 80px;justify-content: flex-start; display: block;">
          <img class="user_photo" width="60" height="60" src="{$info.img_url}" alt="">
          <input type="hidden" name="img_url" value="{$info.img_url}">
          <button type="button" class="btn btn-success btn_select_photo">上传图片</button>
        </span>
      </div>
      <div class="form-group">
        <label>兑换积分</label>
        <input type="number" class="form-control" placeholder="输入兑换商品所需积分" name="integral" value="{$info.integral}">
      </div>
      <div class="form-group">
        <label>商品价格</label>
        <input type="number" class="form-control" placeholder="输入商品价格" name="money" value="{$info.money}">
      </div>
      <div class="form-group">
        <label>商品件数</label>
        <input type="number" class="form-control" placeholder="商品件数" name="total_num" value="{$info.total_num}">
      </div>
      <div class="form-group">
        <label>商品描述</label><br/>
        <textarea placeholder="输入商品描述" name="detail">{$info.detail}</textarea>
      </div>
      <div class="form-group">
        <label>状态</label>
          <input type="hidden" name="status" value="{$info.statusNum}">
          <div class="dropdown" style="display:inline-block">
              <button type="button" class="btn dropdown-toggle" id="dropdownMenu2" data-toggle="dropdown"><span class="statusname">{$info.status}</span>
                  <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                <li role="presentation"  class="statusSelect">
                    <a role="menuitem" tabindex="-1" data-id="0">禁止</a>
                </li>
                <li role="presentation"  class="statusSelect">
                    <a role="menuitem" tabindex="-1" data-id="1">显示</a>
                </li>
              </ul>
          </div>
      </div>

      <button type="submit" class="btn btn-default">提交</button>
    </form>
  </div>
</div>


<script>
    $(function () {
        $(".typeSelect").click(function(){
          var _this = $(this);
          var _this_a = _this.find('a');
          $('input[name=type]').val(_this_a.data('id'));
          $(".typename").text(_this_a.text());
        })
        $(".statusSelect").click(function(){
          var _this = $(this);
          var _this_a = _this.find('a');
          $('input[name=status]').val(_this_a.data('id'));
          $(".statusname").text(_this_a.text());
        })
        $('.btn_select_photo').click(function () {
            console.log(111);
            $('.select_photo').trigger('click')
        });
        $('.select_photo').localResizeIMG({
            maxSize: 200,
            success: function (result) {
                $('.btn_save').attr('disabled', 'disabled');
                $('.user_photo').attr('src', result.base64);
                $.post('{:url("base64Upload")}', {'base64_data': result.base64}, function(res) {
                    $('input[name=img_url]').attr('value', res.data);
                    $('.btn_save').attr('disabled', null);
                }, 'json');
            }
        });
    });

</script>
{include file='common/foot' /}
